webpackJsonp([11],{233:function(e,t,i){"use strict";function o(){l.call(this),this.fConfirmCallback=null,this.confirmDesc=r.observable(""),this.popupHeading=r.observable(""),this.okButtonText=r.observable(a.i18n("COREWEBCLIENT/ACTION_OK")),this.cancelButtonText=r.observable(a.i18n("COREWEBCLIENT/ACTION_CANCEL")),this.shown=!1}var n=i(2),s=i(1),r=i(46),a=i(43),l=i(188);n.extendOwn(o.prototype,l.prototype),o.prototype.PopupTemplate="CoreWebclient_ConfirmPopup",o.prototype.onOpen=function(e,t,i,o,n){this.confirmDesc(e),this.popupHeading(i||""),this.okButtonText(o||a.i18n("COREWEBCLIENT/ACTION_OK")),this.cancelButtonText(n||a.i18n("COREWEBCLIENT/ACTION_CANCEL")),s.isFunction(t)&&(this.fConfirmCallback=t),this.shown=!0},o.prototype.onHide=function(){this.shown=!1},o.prototype.onEnterHandler=function(){this.yesClick()},o.prototype.yesClick=function(){this.shown&&this.fConfirmCallback&&this.fConfirmCallback(!0),this.closePopup()},o.prototype.cancelPopup=function(){this.fConfirmCallback&&this.fConfirmCallback(!1),this.closePopup()},e.exports=new o},255:function(e,t,i){"use strict";function o(){this.iTimeStampInUTC=0,this.oMoment=null}var n=i(51),s=i(43),r=i(211),a=i(45);o.prototype.parse=function(e){this.iTimeStampInUTC=e,this.oMoment=n.unix(this.iTimeStampInUTC)},o.prototype.setDate=function(e,t,i){this.oMoment=n([e,t,i])},o.prototype.getTimeFormat=function(){return a.timeFormat()===window.Enums.TimeFormat.F24?"HH:mm":"hh:mm A"},o.prototype.getFullDate=function(){return this.getDate()+" "+this.getTime()},o.prototype.getMidDate=function(){return this.getShortDate(!0)},o.prototype.getShortDate=function(e){var t="",i=null;return this.oMoment&&(i=n(),i.format("L")===this.oMoment.format("L")?t=this.oMoment.format(this.getTimeFormat()):(t=i.clone().subtract(1,"days").format("L")===this.oMoment.format("L")?s.i18n("COREWEBCLIENT/LABEL_YESTERDAY"):a.UserSelectsDateFormat?this.oMoment.format(r.getDateFormatForMoment(a.dateFormat())):i.year()===this.oMoment.year()?this.oMoment.format("MMM D"):this.oMoment.format("MMM D, YYYY"),e&&(t+=", "+this.oMoment.format(this.getTimeFormat())))),t},o.prototype.getDate=function(){var e="ddd, MMM D, YYYY";return a.UserSelectsDateFormat&&(e="ddd, "+r.getDateFormatForMoment(a.dateFormat())),this.oMoment?this.oMoment.format(e):""},o.prototype.getTime=function(){return this.oMoment?this.oMoment.format(this.getTimeFormat()):""},o.prototype.getTimeStampInUTC=function(){return this.iTimeStampInUTC},e.exports=o},258:function(e,t,i){function o(e){this.sName="",this.visible=n.observable(!0),this.baseHash=n.observable(""),this.hash=n.observable(""),this.linkText=n.observable(e),this.isCurrent=n.observable(!1),this.recivedAnim=n.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=n.observable(0),this.allowChangeTitle=n.observable(!1),this.inactiveTitle=n.observable(""),this.excludedHashes=n.observableArray([])}var n=i(46),s=i(189);o.prototype.ViewTemplate="CoreWebclient_HeaderItemView",o.prototype.setName=function(e){this.sName=e.toLowerCase(),""===this.baseHash()?(this.hash(s.buildHashFromArray([e.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},e.exports=o},268:function(e,t,i){"use strict";function o(e){return void 0===e}function n(e,t){var i=!1;return e&&t&&(i=e===t||(e.contains?e.contains(t):!!t.compareDocumentPosition&&!!(8&t.compareDocumentPosition(e)))),i}function s(e){0<e&&clearTimeout(e),e=0}function r(e){return e=e&&(e.originalEvent?e.originalEvent:e)||window.event,e.dataTransfer?e:null}function a(e,t,i){return e&&t&&!o(e[t])?e[t]:i}function l(e,t,i){e[t]=i}function h(e,t){return function(){return e.apply(o(t)?null:t,Array.prototype.slice.call(arguments))}}function u(e){var t="",i="0123456789abcdefghijklmnopqrstuvwxyz";for(e=o(e)?32:D.pInt(e);t.length<e;)t+=i.substr(Math.round(Math.random()*i.length),1);return t}function c(){return"jua-uid-"+u(16)+"-"+(new Date).getTime()}function p(e,t){var i=o(e.fileName)?o(e.name)?null:e.name:e.fileName,n=o(e.fileSize)?o(e.size)?null:e.size:e.fileSize,s=o(e.type)?null:e.type;return{FileName:i,Size:n,Type:s,Folder:o(t)?"":t,File:e}}function d(e,t,i,n,s,r){var a=0,l=0,h=0,u=null,c=null,d=!1,f=!1,m=function(e,t,i,l){if(e&&!o(e.name))if(t=t||"",e.isFile)e.file(function(e){!d||0<=--s?i(p(e,t)):d&&!f&&0>s&&r&&(f=!0,r(a))});else if(n&&e.isDirectory&&e.createReader){var h=e.createReader(),u=0,c=0;h&&h.readEntries&&h.readEntries(function(o){if(o&&D.isNonEmptyArray(o))for(u=0,c=o.length;u<c;u++)m(o[u],t+e.name+"/",i,l)})}};if(n=!!o(n)||!!n,i=!o(i)&&!!i,s=o(s)?A:D.pInt(s),a=s,d=0<s,e=e&&0<e.length?e:null)for(h=0,l=e.length;h<l;h++)u=e[h],u&&(i?"file"===u.kind&&u.webkitGetAsEntry&&(c=u.webkitGetAsEntry(),c&&m(c,"",t,r)):!d||0<=--s?t(p(u)):d&&!f&&0>s&&r&&(f=!0,r(a)))}function f(e,t,i,o){var n=e&&e.files&&0<e.files.length?e.files:null;n?d(n,t,!1,!1,i,o):t({FileName:e.value.split("\\").pop().split("/").pop(),Size:null,Type:null,Folder:"",File:null})}function m(e){var t=!1;if(e&&e.dataTransfer&&e.dataTransfer.types&&e.dataTransfer.types.length)for(var i=0,o=e.dataTransfer.types.length;i<o;i++)if("files"===e.dataTransfer.types[i].toLowerCase()){t=!0;break}return t}function b(e,t,i,o,n){var s=null,l=null;e=r(e),e&&(s=(e.dataTransfer?a(e.dataTransfer,"items",null):null)||a(e,"items",null),s&&0<s.length&&s[0]&&s[0].webkitGetAsEntry?d(s,t,!0,n,i,o):m(e)&&(l=a(e,"files",null)||(e.dataTransfer?a(e.dataTransfer,"files",null):null),l&&0<l.length&&d(l,t,!1,!1,i,o)))}function y(){return F('<label style="position: absolute; background-color:#fff; right: 0px; top: 0px; left: 0px; bottom: 0px; margin: 0px; padding: 0px; cursor: pointer;"></label>').css({opacity:0})}function g(e,t){return""!==t&&(t=' accept="'+t+'"'),F('<input type="file" tabindex="-1" hidefocus="hidefocus" style="position: absolute; '+e+': -9999px;"'+t+" />")}function E(e,t,i,n){e=o(e)?"":""+e,i=o(i)?"left":""+i,n=o(n)?"":""+n;var s=g(i,n);return 0<e.length&&s.attr("name",e),!o(t)&&!t||s.prop("multiple",!0),s}function v(e,t){return D.pString(P.isFunction(e)?e.apply(null,P.isArray(t)?t:[]):e)}function S(e,t){this.oXhrs={},this.oUids={},this.oJua=e,this.oOptions=t}function T(e,t){this.oUids={},this.oForms={},this.oJua=e,this.oOptions=t}function C(e){e=o(e)?{}:e;var t=this;t.bEnableDnD=!0,t.bEnableButton=!0,t.oEvents={onDialog:null,onSelect:null,onStart:null,onComplete:null,onCompleteAll:null,onProgress:null,onDragEnter:null,onDragLeave:null,onDrop:null,onBodyDragEnter:null,onBodyDragLeave:null,onLimitReached:null},t.oOptions=P.extend({action:"",name:"",hidden:{},queueSize:10,clickElement:!1,dragAndDropElement:!1,dragAndDropBodyElement:!1,disableAjaxUpload:!1,disableFolderDragAndDrop:!0,disableDragAndDrop:!1,disableMultiple:!1,disableDocumentDropPrevent:!1,disableAutoUploadOnDrop:!1,multipleSizeLimit:50,hiddenElementsPosition:"left"},e),t.oQueue=L(D.pInt(a(t.oOptions,"queueSize",10))),t.runEvent("onCompleteAll")&&t.oQueue.await(function(){t.runEvent("onCompleteAll")}),t.oDriver=t.isAjaxUploaderSupported()&&!a(t.oOptions,"disableAjaxUpload",!1)?new S(t,t.oOptions):new T(t,t.oOptions),t.oClickElement=a(t.oOptions,"clickElement",null),t.oClickElement&&(F(t.oClickElement).css({position:"relative",overflow:"hidden"}),"inline"===F(this.oClickElement).css("display")&&F(this.oClickElement).css("display","inline-block"),this.oDriver.generateNewInput(this.oClickElement)),this.oDriver.isDragAndDropSupported()&&a(this.oOptions,"dragAndDropElement",!1)&&!a(this.oOptions,"disableAjaxUpload",!1)?!function(e){var t=F(document),i=F(a(e.oOptions,"dragAndDropBodyElement",!1)||t),o=a(e.oOptions,"dragAndDropElement",!1),l=function(t){if(e.bEnableDnD&&t&&(t=r(t),t&&t.dataTransfer&&m(t)))try{var o=t.dataTransfer.effectAllowed;s(e.iDocTimer),t.dataTransfer.dropEffect="move"===o||"linkMove"===o?"move":"copy",t.stopPropagation(),t.preventDefault(),i.trigger("dragover",t)}catch(e){}},h=function(t){e.bEnableDnD&&t&&(t=r(t),t&&m(t)&&(t.preventDefault(),b(t,function(i){i&&(a(e.oOptions,"disableAutoUploadOnDrop",!1)?e.runEvent("onDrop",[i,t,function(){e.addNewFile(i),s(e.iDocTimer)}]):(e.runEvent("onDrop",[i,t]),e.addNewFile(i),s(e.iDocTimer)))},a(e.oOptions,"multipleSizeLimit",A),e.getEvent("onLimitReached"),!a(e.oOptions,"disableFolderDragAndDrop",!0)))),e.runEvent("onDragLeave",[t])},u=function(t){e.bEnableDnD&&t&&(t=r(t),t&&m(t)&&(s(e.iDocTimer),t.preventDefault(),e.runEvent("onDragEnter",[o,t])))},c=function(t){if(e.bEnableDnD&&t){if(t=r(t)){var i=document.elementFromPoint?document.elementFromPoint(t.clientX,t.clientY):null;if(i&&n(this,i))return;s(e.iDocTimer),e.runEvent("onDragLeave",[o,t])}}else;};o&&(a(e.oOptions,"disableDocumentDropPrevent",!1)||t.on("dragover",function(t){if(e.bEnableDnD&&t&&(t=r(t),t&&t.dataTransfer&&m(t)))try{t.dataTransfer.dropEffect="none",t.preventDefault()}catch(e){}}),i&&i[0]&&i.on("dragover",function(t){e.bEnableDnD&&t&&s(e.iDocTimer)}).on("dragenter",function(t){e.bEnableDnD&&t&&(t=r(t),t&&m(t)&&(s(e.iDocTimer),t.preventDefault(),e.runEvent("onBodyDragEnter",[t])))}).on("dragleave",function(t){e.bEnableDnD&&t&&(t=r(t),t&&(s(e.iDocTimer),e.iDocTimer=setTimeout(function(){e.runEvent("onBodyDragLeave",[t])},200)))}).on("drop",function(t){if(e.bEnableDnD&&t&&(t=r(t))){var i=m(t);return i&&t.preventDefault(),e.runEvent("onBodyDragLeave",[t]),!i}return!1}),F(o).bind("dragenter",u).bind("dragover",l).bind("dragleave",c).bind("drop",h))}(t):t.bEnableDnD=!1,l(t,"on",t.on),l(t,"cancel",t.cancel),l(t,"isDragAndDropSupported",t.isDragAndDropSupported),l(t,"isAjaxUploaderSupported",t.isAjaxUploaderSupported),l(t,"setDragAndDropEnabledStatus",t.setDragAndDropEnabledStatus)}var F=i(1),P=i(2),L=i(269),D=i(44),w=i(179),A=20;S.prototype.oXhrs={},S.prototype.oUids={},S.prototype.oJua=null,S.prototype.oOptions={},S.prototype.isDragAndDropSupported=function(){return!0},S.prototype.regTaskUid=function(e){this.oUids[e]=!0},S.prototype.uploadTask=function(e,t,i,n,s,r){if(!1===this.oUids[e]||!t||!t.File)return i(null,e),!1;try{var l=this,h=new XMLHttpRequest,u=new FormData,c=a(this.oOptions,"action",""),p=a(this.oOptions,"hidden",{}),d=this.oJua.getEvent("onStart"),f=this.oJua.getEvent("onComplete"),m=this.oJua.getEvent("onProgress"),b=null,y=p.Parameters;return h.open("POST",c,!0),h.setRequestHeader("Authorization","Bearer "+F.cookie("AuthToken")),m&&h.upload&&(h.upload.onprogress=function(i){i&&i.lengthComputable&&!o(i.loaded)&&!o(i.total)&&(void 0===r?m(e,i.loaded,i.total):m(e,r+i.loaded>t.Size?t.Size:r+i.loaded,t.Size))}),h.onreadystatechange=function(){if(4===h.readyState&&200===h.status){if(f&&!n){var t=!1,r=null;try{r=F.parseJSON(h.responseText),t=!0}catch(e){r=null}f(e,t,r)}o(l.oXhrs[e])||(l.oXhrs[e]=null),s?i(h.responseText,e):i(null,e)}else 4===h.readyState&&(f(e,!1,null),i(null,e))},d&&d(e),u.append("jua-post-type","ajax"),u.append(a(this.oOptions,"name","juaFile"),t.File,t.FileName),b=JSON.parse(v(p.Parameters,[t])),b=P.extend(b,t.Hidden||{}),p.Parameters=JSON.stringify(b),F.each(p,function(e,i){u.append(e,v(i,[t]))}),p.Parameters=y,h.send(u),this.oXhrs[e]=h,!0}catch(e){window.console&&window.console.error(e)}return i(null,e),!1},S.prototype.generateNewInput=function(e){var t=this,i=null,o=null;e&&(o=E("",!a(this.oOptions,"disableMultiple",!1),a(this.oOptions,"hiddenElementsPosition","left"),a(this.oOptions,"accept","")),i=y(),i.append(o),F(e).append(i),o.on("click",function(e){if(!t.oJua.bEnableButton)return void e.preventDefault();var i=t.oJua.getEvent("onDialog");i&&i()}).on("change",function(){f(this,function(o){t.oJua.addNewFile(o),t.generateNewInput(e),setTimeout(function(){i.remove()},10)},a(t.oOptions,"multipleSizeLimit",A),t.oJua.getEvent("onLimitReached"))}))},S.prototype.cancel=function(e){if(this.oUids[e]=!1,this.oXhrs[e]){try{this.oXhrs[e].abort&&this.oXhrs[e].abort()}catch(e){}this.oXhrs[e]=null}},T.prototype.oUids={},T.prototype.oForms={},T.prototype.oJua=null,T.prototype.oOptions={},T.prototype.isDragAndDropSupported=function(){return!1},T.prototype.regTaskUid=function(e){this.oUids[e]=!0},T.prototype.uploadTask=function(e,t,i,o,n,s){if(!1===this.oUids[e])return i(null,e),!1;var r=this.oForms[e],l=a(this.oOptions,"hidden",{}),h=this.oJua.getEvent("onStart"),u=this.oJua.getEvent("onComplete");return r?(r.append(F('<input type="hidden" />').attr("name","jua-post-type").val("iframe")),F.each(l,function(e,i){r.append(F('<input type="hidden" />').attr("name",e).val(v(i,[t])))}),r.trigger("submit"),h&&h(e),r.find("iframe").on("load",function(t){var o=!1,n=null,s={};if(u){try{n=this.contentDocument?this.contentDocument:this.contentWindow.document,s=F.parseJSON(n.body.innerHTML),o=!0}catch(e){s={}}u(e,o,s)}i(null,e),window.setTimeout(function(){r.remove()},100)})):i(null,e),!0},T.prototype.generateNewInput=function(e){var t=this,i="",o=null,n=null,s=a(this.oOptions,"action",""),r=null,l=a(this.oOptions,"hiddenElementsPosition","left");e&&(i=c(),o=E(a(this.oOptions,"name","juaFile"),!a(this.oOptions,"disableMultiple",!1),a(this.oOptions,"hiddenElementsPosition","left"),a(this.oOptions,"accept","")),r=F('<form action="'+s+'" target="iframe-'+i+'"  method="POST" enctype="multipart/form-data" style="display: block; cursor: pointer;"></form>'),n=F('<iframe name="iframe-'+i+'" tabindex="-1" src="javascript:void(0);"  style="position: absolute; top: -1000px; '+l+': -1000px; cursor: pointer;" />').css({opacity:0}),r.append(y().append(o)).append(n),F(e).append(r),this.oForms[i]=r,o.on("click",function(e){if(!t.oJua.bEnableButton)return void e.preventDefault();var i=t.oJua.getEvent("onDialog");i&&i()}).on("change",function(){f(this,function(o){if(o){var n=a(t.oOptions,"hiddenElementsPosition","left");r.css({position:"absolute",top:-1e3}),r.css(n,-1e3),t.oJua.addFile(i,o),t.generateNewInput(e)}},a(t.oOptions,"multipleSizeLimit",A),t.oJua.getEvent("onLimitReached"))}))},T.prototype.cancel=function(e){this.oUids[e]=!1,this.oForms[e]&&(this.oForms[e].remove(),this.oForms[e]=!1)},C.prototype.bEnableDnD=!0,C.prototype.iDocTimer=0,C.prototype.oOptions={},C.prototype.oEvents={},C.prototype.oQueue=null,C.prototype.oDriver=null,C.prototype.on=function(e,t){return this.oEvents[e]=t,this},C.prototype.runEvent=function(e,t){this.oEvents[e]&&this.oEvents[e].apply(null,t||[])},C.prototype.getEvent=function(e){return this.oEvents[e]||null},C.prototype.cancel=function(e){this.oDriver.cancel(e)},C.prototype.isAjaxUploaderSupported=function(){return function(){var e=document.createElement("input");return e.type="file",!!("XMLHttpRequest"in window&&"multiple"in e&&"FormData"in window&&(new XMLHttpRequest).upload)}()},C.prototype.setDragAndDropEnabledStatus=function(e){this.bEnableDnD=!!e},C.prototype.isDragAndDropSupported=function(){return this.oDriver.isDragAndDropSupported()},C.prototype.addNewFile=function(e){this.addFile(c(),e)},C.prototype.addFile=function(e,t){var i=this.getEvent("onSelect"),o=null,n=!1,s=a(this.oOptions,"hidden",{}),r=this.getEvent("onComplete"),l=P.bind(function(e,t){this.oDriver.regTaskUid(e),this.oQueue.defer(h(this.oDriver.uploadTask,this.oDriver),e,t)},this),u=this.getEvent("onCancel");!t||i&&!1===i(e,t)?this.oDriver.cancel(e):(o=P.bind(function(e,t,i,n,s,a){var l=null;l=function(t,n){var s=null;try{s=F.parseJSON(t)}catch(e){}s&&s.Result&&!s.Result.Error&&!s.ErrorCode?i(e,o):s&&s.Result&&s.Result.Error?(w.broadcastEvent("Jua::FileUploadingError"),r(n,!1,{ErrorCode:s.Result.Error})):s&&s.ErrorCode?(w.broadcastEvent("Jua::FileUploadingError"),r(n,!1,{ErrorCode:s.ErrorCode})):(w.broadcastEvent("Jua::FileUploadingError"),r(n,!1))},this.oDriver.regTaskUid(e),this.oDriver.uploadTask(e,t,l,n<s,!0,a)},this),n=w.broadcastEvent("Jua::FileUpload::before",{sUid:e,oFileInfo:t,fOnChunkReadyCallback:o,sModuleName:s.Module,fRegularUploadFileCallback:l,fCancelFunction:u}),n===!1&&l(e,t))},C.prototype.setOption=function(e,t){this.oOptions[e]=t},e.exports=C},269:function(e,t,i){var o;!function(){function n(e){function t(){for(;a=u<h.length&&e>c;){var t=u++,o=h[t],n=r.call(o,1);n.push(i(t)),++c,o[0].apply(null,n)}}function i(e){return function(i,n){--c,null==d&&(null!=i?(d=i,u=p=NaN,o()):(h[e]=n,--p?a||t():o()))}}function o(){null!=d?f(d):l?f(d,h):f.apply(null,[d].concat(h))}var n,a,l,h=[],u=0,c=0,p=0,d=null,f=s;return e||(e=1/0),n={defer:function(){return d||(h.push(arguments),++p,t()),n},await:function(e){return f=e,l=!1,p||o(),n},awaitAll:function(e){return f=e,l=!0,p||o(),n}}}function s(){}var r=[].slice;n.version="1.0.7",o=function(){return n}.call(t,i,t,e),!(void 0!==o&&(e.exports=o))}()},270:function(e,t,i){"use strict";function o(e,t,i,o,l,u,c,p,d,f){this.fBeforeSelectCallback=null,this.fSelectCallback=t||function(){},this.fDeleteCallback=i||function(){},this.fDblClickCallback=!h.isMobile()&&o?o:function(){},this.fEnterCallback=l||function(){},this.bResetCheckedOnClick=!!c,this.bCheckOnSelect=!!p,this.bUnselectOnCtrl=!!d,this.bDisableMultiplySelection=!!f,this.useKeyboardKeys=r.observable(!1),this.list=r.observableArray([]),e&&e.subscribe&&e.subscribe(function(e){this.list(e)},this),this.multiplyLineFactor=u,this.oLast=null,this.oListScope=null,this.oScrollScope=null,this.iTimer=0,this.iFactor=1,this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Up,this.KeyRight=Enums.Key.Down,this.multiplyLineFactor&&(this.multiplyLineFactor.subscribe?this.multiplyLineFactor.subscribe(function(e){this.iFactor=0<e?e:1},this):this.iFactor=a.pInt(this.multiplyLineFactor),this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Left,this.KeyRight=Enums.Key.Right,s("html").hasClass("rtl")&&(this.KeyLeft=Enums.Key.Right,this.KeyRight=Enums.Key.Left)),this.sActionSelector="",this.sSelectabelSelector="",this.sCheckboxSelector="";var m=this;this.listChecked=r.computed({read:function(){var e=n.filter(this.list(),function(e){var t=e.checked(),i=e.selected();return t||m.bCheckOnSelect&&i});return e},write:function(e){e=!!e,n.each(this.list(),function(t){t.checked(e)}),this.list.valueHasMutated()},owner:this}),this.checkAll=r.computed({read:function(){return 0<this.listChecked().length},write:function(e){this.listChecked(!!e)},owner:this}),this.selectorHook=r.observable(null),this.selectorHook.subscribe(function(){var e=this.selectorHook();e&&e.selected(!1)},this,"beforeChange"),this.selectorHook.subscribe(function(e){e&&e.selected(!0)},this),this.itemSelected=r.computed({read:this.selectorHook,write:function(e){this.selectorHook(e),e&&(this.oLast=e)},owner:this}),this.list.subscribe(function(e){if(n.isArray(e)){var t=this.itemSelected();t&&(n.find(e,function(e){return t===e})||this.itemSelected(null))}else this.itemSelected(null)},this),this.listCheckedOrSelected=r.computed({read:function(){var e=this.itemSelected(),t=this.listChecked();return 0<t.length?t:e?[e]:[]},write:function(e){e?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.listCheckedAndSelected=r.computed({read:function(){var e=[],t=this.itemSelected(),i=this.listChecked();return i&&(e=i.slice(0)),t&&n.indexOf(i,t)===-1&&e.push(t),e},write:function(e){e?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.isIncompleteChecked=r.computed(function(){var e=this.list().length,t=this.listChecked().length;return 0<e&&0<t&&e>t},this),this.onKeydownBound=n.bind(this.onKeydown,this)}var n=i(2),s=i(1),r=i(46),a=i(44),l=i(211),h=i(179),u=i(178);o.prototype.iTimer=0,o.prototype.bResetCheckedOnClick=!1,o.prototype.bCheckOnSelect=!1,o.prototype.bUnselectOnCtrl=!1,o.prototype.bDisableMultiplySelection=!1,o.prototype.setBeforeSelectCallback=function(e){this.fBeforeSelectCallback=e||null},o.prototype.getLastOrSelected=function(){var e=0,t=null;return n.each(this.list(),function(i){i.checked()&&e++,i.selected()&&(t=i)}),0===e&&t?t:this.oLast},o.prototype.initOnApplyBindings=function(e,t,i,o,n){s(document).on("keydown",this.onKeydownBound),this.oListScope=o,this.oScrollScope=n,this.sActionSelector=e,this.sSelectabelSelector=t,this.sCheckboxSelector=i;var a=this,l=function(e,t,i){var o=0,n=0,s=null,r=!1,l=!1,h=[],u=!1;if(t=t?t:null,i&&i.shiftKey&&null!==t&&null!==e&&t!==e)for(h=a.list(),u=t.checked(),o=0,n=h.length;o<n;o++)s=h[o],r=!1,s!==e&&s!==t||(r=!0),r&&(l=!l),(l||r)&&s.checked(u);t&&(a.oLast=t)};s(this.oListScope).on("dblclick",e,function(e){var t=r.dataFor(this);!t||!e||e.ctrlKey||e.altKey||e.shiftKey||a.onDblClick(t)}),u.mobileDevice&&s(this.oListScope).on("touchstart",e,function(e){if(e){var t=e.timeStamp,i=s(this).data("lastTouch")||t,o=t-i,n=e.originalEvent&&e.originalEvent.touches?e.originalEvent.touches.length:0;s(this).data("lastTouch",t),!o||o>250||n>1||(e.preventDefault(),s(this).trigger("dblclick"))}}),s(this.oListScope).on("click",e,function(e){var t=!0,i=null,o=a.getLastOrSelected(),n=r.dataFor(this);n&&e&&(e.shiftKey?(t=!1,a.bDisableMultiplySelection||(null===a.oLast&&(a.oLast=n),n.checked(!n.checked()),l(o,n,e))):e.ctrlKey&&(t=!1,a.bDisableMultiplySelection||(a.oLast=n,i=a.itemSelected(),!i||i.checked()||n.checked()||i.checked(!0),a.bUnselectOnCtrl&&n===a.itemSelected()?(n.checked(!n.selected()),a.itemSelected(null)):n.checked(!n.checked()))),t&&(a.onSelect(n,!0),a.scrollToSelected()))}),s(this.oListScope).on("click",i,function(e){var t=r.dataFor(this);t&&e&&!a.bDisableMultiplySelection&&(e.shiftKey?(null===a.oLast&&(a.oLast=t),l(a.getLastOrSelected(),t,e)):a.oLast=t),e&&e.stopPropagation&&e.stopPropagation()}),s(this.oListScope).on("dblclick",i,function(e){e&&e.stopPropagation&&e.stopPropagation()})},o.prototype.getResultSelection=function(e,t){var i=this,o=!1,r=!1,a=null,l=this.iFactor,h=!!this.multiplyLineFactor,u=0,c=0,p=[];if(!e&&-1<s.inArray(t,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]))p=this.list(),p&&0<p.length&&(-1<s.inArray(t,[this.KeyDown,this.KeyRight,Enums.Key.PageUp,Enums.Key.Home])?a=p[0]:-1<s.inArray(t,[this.KeyUp,this.KeyLeft,Enums.Key.PageDown,Enums.Key.End])&&(a=p[p.length-1]));else if(e&&(p=this.list(),c=p?p.length:0,0<c))if(Enums.Key.Home===t||Enums.Key.PageUp===t||Enums.Key.End===t||Enums.Key.PageDown===t||h&&(Enums.Key.Left===t||Enums.Key.Right===t)||!h&&(Enums.Key.Up===t||Enums.Key.Down===t))n.each(p,function(n){if(!o)switch(t){case i.KeyUp:case i.KeyLeft:e===n?o=!0:a=n;break;case Enums.Key.Home:case Enums.Key.PageUp:a=n,o=!0;break;case i.KeyDown:case i.KeyRight:r?(a=n,o=!0):e===n&&(r=!0);break;case Enums.Key.End:case Enums.Key.PageDown:a=n}});else if(h&&this.KeyDown===t){for(;u<c;u++)if(e===p[u]){u+=l,c-1<u&&(u-=l),a=p[u];break}}else if(h&&this.KeyUp===t)for(u=c;u>=0;u--)if(e===p[u]){u-=l,0>u&&(u+=l),a=p[u];break}return a},o.prototype.shiftClickResult=function(e,t,i){if(t){var o=!!this.multiplyLineFactor,r=!1,a=!1;-1<s.inArray(i,o?[Enums.Key.Left,Enums.Key.Right]:[Enums.Key.Up,Enums.Key.Down])?t.checked(!t.checked()):-1<s.inArray(i,o?[Enums.Key.Up,Enums.Key.Down,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]:[Enums.Key.Left,Enums.Key.Right,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&(a=!t.checked(),n.each(this.list(),function(i){var o=!1;i!==e&&t!==i||(r=!r,o=!0),(r||o)&&(i.checked(a),o=!1)}),o&&e&&(i===Enums.Key.Up||i===Enums.Key.Down)&&e.checked(!e.checked()))}},o.prototype.clickNewSelectPosition=function(e,t){var i=this,o=0,n=null,r=this.itemSelected();n=this.getResultSelection(r,e),n?(t&&this.shiftClickResult(n,r,e),n&&this.fBeforeSelectCallback?(this.fBeforeSelectCallback(n,function(e){e&&(i.itemSelected(n),o=0===i.iTimer?50:150,0!==i.iTimer&&window.clearTimeout(i.iTimer),i.iTimer=window.setTimeout(function(){i.iTimer=0,i.onSelect(n,!1)},o),this.scrollToSelected())}),this.scrollToSelected()):(this.itemSelected(n),o=0===this.iTimer?50:150,0!==this.iTimer&&window.clearTimeout(this.iTimer),this.iTimer=window.setTimeout(function(){i.iTimer=0,i.onSelect(n,!0)},o),this.scrollToSelected())):r&&t&&-1<s.inArray(e,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&r.checked(!r.checked())},o.prototype.onKeydown=function(e){var t=!0,i=0;return this.useKeyboardKeys()&&e&&!l.isTextFieldFocused()&&(i=e.keyCode,e.ctrlKey||this.KeyUp!==i&&this.KeyDown!==i&&this.KeyLeft!==i&&this.KeyRight!==i&&Enums.Key.PageUp!==i&&Enums.Key.PageDown!==i&&Enums.Key.Home!==i&&Enums.Key.End!==i?Enums.Key.Del!==i||e.ctrlKey||e.shiftKey?Enums.Key.Enter===i?0<this.list().length&&!e.ctrlKey&&(this.onEnter(this.itemSelected()),t=!1):!e.ctrlKey||e.altKey||e.shiftKey||Enums.Key.a!==i||(this.checkAll(!(this.checkAll()&&!this.isIncompleteChecked())),t=!1):0<this.list().length&&(this.onDelete(),t=!1):(this.clickNewSelectPosition(i,e.shiftKey),t=!1)),t},o.prototype.onDelete=function(){this.fDeleteCallback.call(this,this.listCheckedOrSelected())},o.prototype.onEnter=function(e){var t=this;e&&this.fBeforeSelectCallback?this.fBeforeSelectCallback(e,function(i){i&&(t.itemSelected(e),t.fEnterCallback.call(this,e))}):(this.itemSelected(e),this.fEnterCallback.call(this,e))},o.prototype.selectionFunc=function(e){var t=n.bind(function(){this.itemSelected(null),this.bResetCheckedOnClick&&this.listChecked(!1),this.itemSelected(e),this.fSelectCallback.call(this,e)},this),i={Item:e,Cancel:!1,ProceedSelectionHandler:t};h.broadcastEvent("CoreWebclient::SelectListItem::before",i),i.Cancel||t()},o.prototype.onSelect=function(e,t){if(this.fBeforeSelectCallback&&t){var i=this;this.fBeforeSelectCallback(e,function(t){t&&i.selectionFunc(e)})}else this.selectionFunc(e)},o.prototype.onDblClick=function(e){this.fDblClickCallback.call(this,e)},o.prototype.koCheckAll=function(){return r.computed({read:this.checkAll,write:this.checkAll,owner:this})},o.prototype.koCheckAllIncomplete=function(){return r.computed({read:this.isIncompleteChecked,write:this.isIncompleteChecked,owner:this})},o.prototype.scrollToSelected=function(){if(!this.oListScope||!this.oScrollScope)return!1;var e=20,t=s(this.sSelectabelSelector,this.oScrollScope),i=t.position(),o=this.oScrollScope.height(),n=t.outerHeight();return!(!i||!(i.top<0||i.top+n>o))&&(i.top<0?this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+i.top-e):this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+i.top-o+n+e),!0)},e.exports=o},311:function(e,t,i){"use strict";e.exports=function(e){i(312);var t=i(179),o=i(43),n=i(313),s=null,r=t.getUserRole()===Enums.UserRole.SuperAdmin,a=t.getUserRole()===Enums.UserRole.NormalUser,l=[],h=null;if(n.init(e),t.isPublic())return{getScreens:function(){var e={};return e[n.HashModuleName]=function(){var e=i(314);return new e},e}};if(r||a){if(r)return{start:function(e){e.run("AdminPanelWebclient","registerAdminPanelTab",[function(e){i.e(1,function(){e(i(329))})},n.HashModuleName,o.i18n("FILESWEBCLIENT/LABEL_SETTINGS_TAB")])}};if(a)return t.isNewTab()?{getSelectFilesPopup:function(){return i(326)}}:{enableModule:n.enableModule,start:function(e){(n.ShowCommonSettings||n.ShowFilesApps)&&e.run("SettingsWebclient","registerSettingsTab",[function(){return i(327)},n.HashModuleName,o.i18n("FILESWEBCLIENT/LABEL_SETTINGS_TAB")])},getScreens:function(){var e={};return e[n.HashModuleName]=function(){var e=i(314);return h=new e,h.registerToolbarButtons(l),l=[],h},e},getHeaderItem:function(){if(null===s){var e=i(258),t=""!==n.CustomTabTitle?n.CustomTabTitle:o.i18n("FILESWEBCLIENT/ACTION_SHOW_FILES");s=new e(t)}return{item:s,name:n.HashModuleName}},getSelectFilesPopup:function(){return i(326)},getMobileSyncSettingsView:function(){return i(328)},registerToolbarButtons:function(e){h?h.registerToolbarButtons([e]):l.push(e)}}}return null}},312:function(e,t,i){"use strict";var o=i(2),n={};n.FileStorageType={Personal:"personal",Corporate:"corporate",Shared:"shared",GoogleDrive:"google",Dropbox:"dropbox"},n.FileStorageLinkType={Unknown:0,GoogleDrive:1,Dropbox:2,YouTube:3,Vimeo:4,SoundCloud:5},void 0===window.Enums&&(window.Enums={}),o.extendOwn(window.Enums,n)},313:function(e,t,i){"use strict";var o=i(46),n=i(2),s=i(44);e.exports={ServerModuleName:"Files",HashModuleName:"files",CustomTabTitle:"",enableModule:o.observable(!0),EnableUploadSizeLimit:!1,PublicFolderName:"",PublicHash:"",UploadSizeLimitMb:0,UserSpaceLimitMb:0,EditFileNameWithoutExtention:!1,ShowCommonSettings:!0,ShowFilesApps:!0,init:function(e){var t=e[this.ServerModuleName],i=e.FilesWebclient;n.isEmpty(t)||(this.CustomTabTitle=s.pString(t.CustomTabTitle,this.CustomTabTitle),this.enableModule=o.observable(s.pBool(t.EnableModule,this.enableModule())),this.EnableUploadSizeLimit=s.pBool(t.EnableUploadSizeLimit,this.EnableUploadSizeLimit),this.PublicFolderName=s.pString(t.PublicFolderName,this.PublicFolderName),this.PublicHash=s.pString(t.PublicHash,this.PublicHash),this.UploadSizeLimitMb=s.pNonNegativeInt(t.UploadSizeLimitMb,this.UploadSizeLimitMb),this.UserSpaceLimitMb=s.pNonNegativeInt(t.UserSpaceLimitMb,this.UserSpaceLimitMb)),n.isEmpty(i)||(this.EditFileNameWithoutExtention=s.pBool(i.EditFileNameWithoutExtention,this.EditFileNameWithoutExtention),this.ShowCommonSettings=s.pBool(i.ShowCommonSettings,this.ShowCommonSettings),this.ShowFilesApps=s.pBool(i.ShowFilesApps,this.ShowFilesApps))},update:function(e){this.enableModule("1"===e)},updateAdmin:function(e,t,i){this.EnableUploadSizeLimit=e,this.UploadSizeLimitMb=t,this.UserSpaceLimitMb=i}}},314:function(e,t,i){"use strict";function o(e){y.call(this,"FilesWebclient"),this.browserTitle=r.observable(a.i18n("FILESWEBCLIENT/HEADING_BROWSER_TAB")),this.bAllowSendEmails=n.isFunction(L),this.error=r.observable(!1),this.loaded=r.observable(!1),this.bPublic=c.isPublic(),this.storages=r.observableArray(),this.folders=r.observableArray(),this.files=r.observableArray(),this.uploadingFiles=r.observableArray(),this.rootPath=r.observable(this.bPublic?A.PublicFolderName:a.i18n("FILESWEBCLIENT/LABEL_PERSONAL_STORAGE")),this.storageType=r.observable(I.FileStorageType.Personal),this.storageDisplayName=r.computed(function(){var e=this.getStorageByType(this.storageType());return e?e.displayName:""},this),this.storageType.subscribe(function(){if(this.bPublic)this.rootPath(A.PublicFolderName);else{var e=this.getStorageByType(this.storageType());e?this.rootPath(e.displayName):"corporate"===this.storageType()&&this.rootPath(a.i18n("FILESWEBCLIENT/LABEL_CORPORATE_STORAGE")),this.selector.listCheckedAndSelected(!1)}},this),this.pathItems=r.observableArray(),this.currentPath=r.observable(""),this.dropPath=r.observable(""),r.computed(function(){this.dropPath(this.currentPath())},this),this.filesCollection=r.computed(function(){var e=n.union(this.files(),this.getUploadingFiles());return e.sort(function(e,t){return e.fileName()===t.fileName()?0:e.fileName()<t.fileName()?-1:1}),e},this),this.collection=r.computed(function(){return n.union(this.folders(),this.filesCollection())},this),this.columnCount=r.observable(1),this.selector=new d(this.collection,null,n.bind(this.onItemDelete,this),n.bind(this.onItemDblClick,this),n.bind(this.onEnter,this),this.columnCount,!0,!0,!0),this.firstSelectedFile=r.computed(function(){return n.find(this.selector.listCheckedAndSelected(),function(e){return e instanceof k})},this),this.searchPattern=r.observable(""),this.newSearchPattern=r.observable(""),this.isSearchFocused=r.observable(!1),this.renameCommand=h.createCommand(this,this.executeRename,function(){var e=this.selector.listCheckedAndSelected();return 1===e.length}),this.deleteCommand=h.createCommand(this,this.executeDelete,function(){var e=this.selector.listCheckedAndSelected(),t=e.every(function(e){return!(void 0!==e.uploaded&&e.uploaded()===!1||void 0!==e.downloading&&e.downloading()===!0)});return 0<e.length&&t}),this.selectedCount=r.computed(function(){return this.selector.listCheckedAndSelected().length},this),this.downloadCommand=h.createCommand(this,this.executeDownload,function(){var e=this.getFileIfOnlyOneSelected();return!!e&&e.hasAction("download")}),this.shareCommand=h.createCommand(this,this.executeShare,function(){var e=this.selector.listCheckedAndSelected();return 1===e.length&&!e[0].bIsLink}),this.sendCommand=h.createCommand(this,this.executeSend,function(){var e=this.selector.listCheckedAndSelected(),t=n.filter(e,function(e){return e instanceof k;
},this);return t.length>0}),this.uploaderButton=r.observable(null),this.uploaderArea=r.observable(null),this.bDragActive=r.observable(!1),this.bDragActiveComp=r.computed(function(){var e=this.bDragActive();return e&&""===this.searchPattern()},this),this.bAllowDragNDrop=!1,this.uploadError=r.observable(!1),this.quota=r.observable(0),this.used=r.observable(0),this.quotaDesc=r.observable(""),this.quotaProc=r.observable(-1),r.computed(function(){if(!b.ShowQuotaBar)return!0;var e=this.quota(),t=this.used(),i=0<e?Math.ceil(t/e*100):-1;i=100<i?100:i,this.quotaProc(i),this.quotaDesc(-1<i?a.i18n("COREWEBCLIENT/INFO_QUOTA",{PROC:i,QUOTA:a.getFriendlySize(e)}):"")},this),this.dragover=r.observable(!1),this.loading=r.observable(!1),this.loadedFiles=r.observable(!1),this.fileListInfoText=r.computed(function(){var e="";return this.loading()?e=a.i18n("COREWEBCLIENT/INFO_LOADING"):this.loadedFiles()?0===this.collection().length&&(""!==this.searchPattern()?e=a.i18n("FILESWEBCLIENT/INFO_NOTHING_FOUND"):""!==this.currentPath()||this.bInPopup||this.bPublic?e=a.i18n("FILESWEBCLIENT/INFO_FOLDER_IS_EMPTY"):this.bAllowDragNDrop&&(e=a.i18n("FILESWEBCLIENT/INFO_DRAGNDROP_FILES_OR_CREATE_FOLDER"))):this.error()&&(e=a.i18n("FILESWEBCLIENT/ERROR_FILES_NOT_RECEIVED")),e},this),this.dragAndDropHelperBound=n.bind(this.dragAndDropHelper,this),this.bInPopup=!!e,this.isCurrentStorageExternal=r.computed(function(){var e=this.getStorageByType(this.storageType());return e&&e.isExternal},this),this.timerId=null;var t={View:this,TemplateName:"FilesWebclient_ItemsView"};this.itemsViewTemplate=r.observable(t.TemplateName),c.broadcastEvent("Files::ChangeItemsView",t),this.addToolbarButtons=r.observableArray([]),c.subscribeEvent("Files::ShowList",n.bind(function(e){e.Item&&this.routeFiles(e.Item.storageType(),e.Item.fullPath())},this)),c.broadcastEvent("FilesWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this}),v.opened.subscribe(n.bind(function(){this.shown()&&this.selector.useKeyboardKeys(!0)},this))}var n=i(2),s=i(1),r=i(46),a=i(43),l=i(44),h=i(211),u=i(181),c=i(179),p=i(268),d=i(270),f=i(189),m=i(182),b=i(45),y=i(192),g=i(186),E=i(187),v=i(233),S=i(315),T=i(316),C=i(322),F=i(323),P=i(42),L=P.run("MailWebclient","getComposeMessageWithAttachments"),D=i(325),w=i(317),A=i(313),k=i(318),N=i(324),I=window.Enums;n.extendOwn(o.prototype,y.prototype),o.prototype.ViewTemplate=c.isPublic()?"FilesWebclient_PublicFilesView":"FilesWebclient_FilesView",o.prototype.ViewConstructorName="CFilesView",o.prototype.onBind=function(e){var t=this.$viewDom||e;this.selector.initOnApplyBindings(".items_sub_list .item",".items_sub_list .selected.item",".items_sub_list .item .custom_checkbox",s(".panel.files .items_list",t),s(".panel.files .items_list .files_scroll.scroll-inner",t)),this.initUploader(),this.hotKeysBind()},o.prototype.hotKeysBind=function(){s(document).on("keydown",n.bind(function(e){this.shown()&&e&&e.keyCode===I.Key.s&&this.selector.useKeyboardKeys()&&!h.isTextFieldFocused()&&(e.preventDefault(),this.isSearchFocused(!0))},this))},o.prototype.initUploader=function(){var e=this;!this.bPublic&&this.uploaderButton()&&this.uploaderArea()&&(this.oJua=new p({action:"?/Api/",name:"jua-uploader",queueSize:2,clickElement:this.uploaderButton(),hiddenElementsPosition:b.IsRTL?"right":"left",dragAndDropElement:this.uploaderArea(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:n.extendOwn({Module:A.ServerModuleName,Method:"UploadFile",Parameters:function(t){return JSON.stringify({Type:e.storageType(),SubPath:t&&t.Folder||"",Path:e.dropPath()})}},c.getCommonRequestParameters())}),this.oJua.on("onProgress",n.bind(this.onFileUploadProgress,this)).on("onSelect",n.bind(this.onFileUploadSelect,this)).on("onStart",n.bind(this.onFileUploadStart,this)).on("onDrop",n.bind(this.onDrop,this)).on("onComplete",n.bind(this.onFileUploadComplete,this)).on("onBodyDragEnter",n.bind(this.bDragActive,this,!0)).on("onBodyDragLeave",n.bind(this.bDragActive,this,!1)).on("onCancel",n.bind(this.onCancelUpload,this)),this.bAllowDragNDrop=this.oJua.isDragAndDropSupported())},o.prototype.onFileUploadSelect=function(e,t){if(A.UploadSizeLimitMb>0&&t.Size/1048576>A.UploadSizeLimitMb)return g.showPopup(E,[a.i18n("FILESWEBCLIENT/ERROR_SIZE_LIMIT",{FILENAME:t.FileName,SIZE:A.UploadSizeLimitMb})]),!1;if(this.storageType()===I.FileStorageType.Personal&&l.isPositiveNumber(this.quota())&&this.quota()>0&&this.used()+t.Size>this.quota())return g.showPopup(E,[a.i18n("COREWEBCLIENT/ERROR_CANT_UPLOAD_FILE_QUOTA")]),!1;if(""===this.searchPattern()){var i=k.prepareUploadFileData(t,this.currentPath(),this.storageType(),n.bind(function(e){return!!this.getFileByName(e)||!!n.find(this.getUploadingFiles(),function(t){return t.fileName()===e})},this)),o=new k(i);o.onUploadSelect(e,t,!0),this.uploadingFiles.push(o)}},o.prototype.onFileUploadStart=function(e){var t=this.getUploadFileByUid(e);t&&t.onUploadStart()},o.prototype.onFileUploadProgress=function(e,t,i){if(""===this.searchPattern()){var o=this.getUploadFileByUid(e);o&&o.onUploadProgress(t,i)}},o.prototype.onFileUploadComplete=function(e,t,i){if(""===this.searchPattern()){var o=this.getUploadFileByUid(e),n=!1;o?(o.onUploadComplete(e,t,i),this.deleteUploadFileByUid(e),o.uploadError()?(this.uploadError(!0),i&&i.ErrorCode===I.Errors.CanNotUploadFileQuota?(g.showPopup(E,[a.i18n("COREWEBCLIENT/ERROR_CANT_UPLOAD_FILE_QUOTA")]),n=!0):i&&i.ErrorCode===I.Errors.FileAlreadyExists?(n=!0,m.showError(a.i18n("COREWEBCLIENT/ERROR_FILE_ALREADY_EXISTS"))):i&&i.ErrorCode===I.Errors.FileNotFound?(n=!0,m.showError(a.i18n("COREWEBCLIENT/ERROR_FILE_NOT_FOUND"))):m.showError(o.statusText())):(this.files.push(o),0===this.uploadingFiles().length&&(m.showReport(a.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),n=!0))):n=!0,n&&this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)}},o.prototype.onDrop=function(e,t){if(!this.bPublic)if(t&&t.target&&""===this.searchPattern()){var i=r.dataFor(t.target);i&&i instanceof N&&this.dropPath(i.fullPath())}else m.showReport(a.i18n("FILESWEBCLIENT/INFO_CANNOT_UPLOAD_SEARCH_RESULT"))},o.prototype.filesDrop=function(e,t,i){if(t){var o=this.selector.listCheckedAndSelected(),n=t.ctrlKey?"Copy":"Move";this.moveItems(n,e,o)&&h.uiDropHelperAnim(t,i)}},o.prototype.moveItems=function(e,t,i){if(this.bPublic)return!1;var o="",s="",r=!0,l=!1,h=t instanceof N?t.fullPath():"",u=[],c=t?t instanceof N?t.storageType():t.type:this.storageType(),p=this.getStorageByType(c),d=this.getStorageByType(this.storageType()),f=p.type===d.type,m=this.used(),b=this.quota(),y=!0;if(f||!f&&!p.isExternal&&!d.isExternal){if(p.type===I.FileStorageType.Personal&&(y=n.every(i,function(e){if(e instanceof k){if(b>0&&m+e.size()>b)return!1;m+=e.size()}return!0}),!y))return g.showPopup(E,[a.i18n("FILESWEBCLIENT/ERROR_CANT_MOVE_FILES_QUOTA_PLURAL",{},"",i.length)]),!1;if(n.each(i,n.bind(function(t){(""!==o&&o!==t.path()||""!==s&&s!==t.storageType())&&(r=!1),o=t.path(),s=t.storageType(),l=t instanceof N&&h===o+"/"+t.id(),l||("Move"===e&&(t instanceof k?this.deleteFileByName(t.id()):this.deleteFolderByName(t.fileName())),u.push({FromType:s,FromPath:o,Name:t.id(),IsFolder:t instanceof N}))},this)),u.length>0)return r||(s="",o=""),w.send(e,{FromType:s,ToType:c,FromPath:o,ToPath:h,Files:u},this.onMoveResponse,this),t instanceof N&&t.recivedAnim(!0),!0}return!1},o.prototype.onMoveResponse=function(e,t){e.Result?this.storageType()===t.Parameters.ToType&&this.currentPath()===t.Parameters.ToPath?this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern()):this.getQuota():(e.ErrorCode===I.Errors.CanNotUploadFileQuota?g.showPopup(E,[a.i18n("FILESWEBCLIENT/ERROR_CANT_MOVE_FILES_QUOTA_PLURAL",{},"",t.Parameters.Files.length)]):u.showErrorByCode(e,a.i18n("FILESWEBCLIENT/ERROR_FILES_MOVE_PLURAL",{},"",t.Parameters.Files.length)),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern()))},o.prototype.dragAndDropHelper=function(e){e&&e.checked(!0);var t=h.draggableItems(),i=this.selector.listCheckedAndSelected(),o=i.length,r=0,l=0,u="";return n.each(i,function(e){e instanceof N?l++:r++},this),0!==r&&0!==l?u=a.i18n("FILESWEBCLIENT/LABEL_DRAG_ITEMS_PLURAL",{COUNT:o},null,o):0===r?u=a.i18n("FILESWEBCLIENT/LABEL_DRAG_FOLDERS_PLURAL",{COUNT:l},null,l):0===l&&(u=a.i18n("FILESWEBCLIENT/LABEL_DRAG_FILES_PLURAL",{COUNT:r},null,r)),s(".count-text",t).text(u),t},o.prototype.onItemDelete=function(){var e=this.selector.listCheckedAndSelected(),t=e.every(function(e){return!(void 0!==e.uploaded&&e.uploaded()===!1||void 0!==e.downloading&&e.downloading()===!0)});0<e.length&&t&&this.executeDelete()},o.prototype.onEnter=function(e){this.onItemDblClick(e)},o.prototype.onItemDblClick=function(e){if(e){var t=e.getMainAction();switch(t){case"view":e instanceof k&&(this.onSelectClickPopupBound?this.onSelectClickPopupBound():e.executeAction(t));break;case"list":this.routeFiles(e.storageType(),e.fullPath())}}},o.prototype.onGetFilesResponse=function(e,t){var i=e.Result,o=t.Parameters;if(this.bNotLoading=!1,(o.Type===this.storageType()||o.Hash===A.PublicHash)&&o.Path===this.currentPath())if(i){var s=[],r=[];n.each(i.Items,function(e){if(e.IsFolder){var t=new N;t.parse(e),s.push(t)}else{var i=new k(e,this.bInPopup);i.oExtendedProps.Loading&&(i.uploadError(!0),i.statusText(a.i18n("COREWEBCLIENT/LABEL_FILE_LOADING"))),i.index(r.length),r.push(i)}},this),n.each(this.files(),function(e,t,i){if(e.downloading()){var o=n.findIndex(r,function(t){return e.fileName()===t.fileName()});o!==-1&&(i[t].index(r[o].index()),r[o]=i[t])}}),this.folders(s),this.files(r),this.newSearchPattern(o.Pattern||""),this.searchPattern(o.Pattern||""),this.loadedFiles(!0),clearTimeout(this.timerId),this.parseQuota(i.Quota),n.isArray(i.Path)&&(this.pathItems.removeAll(),n.each(i.Path.reverse(),n.bind(function(e){var t=new N;t.parse(e),this.pathItems.push(t)},this))),this.loading(!1)}else e.ErrorCode!==I.Errors.NotDisplayedError&&(this.loading(!1),this.error(!0))},o.prototype.parseQuota=function(e){e&&(this.quota(e.Limit),this.used(e.Used))},o.prototype.onDeleteResponse=function(e,t){e.Result?(this.expungeFileItems(),this.getQuota()):this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern())},o.prototype.executeRename=function(){var e=n.first(this.selector.listCheckedAndSelected()),t=A.EditFileNameWithoutExtention&&"CFileModel"===e.constructor.name,i=t?h.getFileNameWithoutExtension(e.fileName()):e.fileName(),o=t?h.getFileExtension(e.fileName()):"";!this.bPublic&&e&&g.showPopup(C,[i,n.bind(this.renameItem,this,o)])},o.prototype.renameItem=function(e,t){var i=""===e?t:t+"."+e,o=n.first(this.selector.listCheckedAndSelected());return h.validateFileOrFolderName(i)?(w.send("Rename",{Type:o.storageType(),Path:o.path(),Name:o.id(),NewName:i,IsLink:o.bIsLink?1:0},this.onRenameResponse,this),""):o instanceof N?a.i18n("FILESWEBCLIENT/ERROR_INVALID_FOLDER_NAME"):a.i18n("FILESWEBCLIENT/ERROR_INVALID_FILE_NAME")},o.prototype.getFileIfOnlyOneSelected=function(){var e=this.selector.listCheckedAndSelected();return 1===e.length&&e[0]instanceof k?e[0]:null},o.prototype.executeDownload=function(){var e=this.getFileIfOnlyOneSelected();e&&e.executeAction("download")},o.prototype.executeShare=function(){var e=n.first(this.selector.listCheckedAndSelected());!this.bPublic&&e&&g.showPopup(F,[e])},o.prototype.executeSend=function(){var e=this.selector.listCheckedAndSelected(),t=n.filter(e,function(e){return e instanceof k},this),i=n.map(t,function(e){return{Storage:e.storageType(),Path:e.path(),Name:e.fileName(),Id:e.id()}});this.bAllowSendEmails&&t.length>0&&w.send("SaveFilesAsTempFiles",{Files:i},function(e){e.Result&&L(e.Result)},this)},o.prototype.onShareIconClick=function(e){e&&g.showPopup(F,[e])},o.prototype.onRenameResponse=function(e,t){e.Result||u.showErrorByCode(e,a.i18n("FILESWEBCLIENT/ERROR_FILE_RENAME")),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},o.prototype.executeDelete=function(){var e=this.selector.listCheckedAndSelected()||[],t=e.length,i=!!n.find(e,function(e){return e instanceof N}),o=!!n.find(e,function(e){return!(e instanceof N)}),s="";s=i&&o?a.i18n("FILESWEBCLIENT/CONFIRM_DELETE_ITEMS_PLURAL",{COUNT:t},null,t):i?a.i18n("FILESWEBCLIENT/CONFIRM_DELETE_FOLDERS_PLURAL",{COUNT:t},null,t):a.i18n("FILESWEBCLIENT/CONFIRM_DELETE_FILES_PLURAL",{COUNT:t},null,t),!this.bPublic&&t>0&&(this.selector.useKeyboardKeys(!1),g.showPopup(v,[s,n.bind(this.deleteItems,this,e),"",a.i18n("COREWEBCLIENT/ACTION_DELETE")]))},o.prototype.onShow=function(){this.loaded(!0),this.bPublic?this.routeFiles(this.storageType(),this.currentPath()):this.requestStorages(),this.selector.useKeyboardKeys(!0),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0)},o.prototype.onHide=function(){this.selector.useKeyboardKeys(!1),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1)},o.prototype.getQuota=function(){w.send("GetQuota",{},function(e){e.Result&&this.parseQuota(e.Result)},this)},o.prototype.getStorageByType=function(e){return n.find(this.storages(),function(t){return t.type===e})},o.prototype.requestStorages=function(){w.send("GetStorages",null,this.onGetStoragesResponse,this)},o.prototype.onGetStoragesResponse=function(e,t){var i=e.Result;i&&(n.each(i,function(e){e.Type&&!this.getStorageByType(e.Type)&&this.storages.push({isExternal:e.IsExternal,type:e.Type,displayName:e.DisplayName})},this),this.expungeExternalStorages(n.map(i,function(e){return e.Type},this))),this.getStorageByType(this.storageType())||(this.storageType(I.FileStorageType.Personal),this.pathItems.removeAll()),this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},o.prototype.showLoading=function(){this.folders([]),this.files([]),this.loading(!0)},o.prototype.routeFiles=function(e,t,i,o){var n=!1,s=!1;this.bPublic?(n=f.setHash(D.getFiles("",t,"")),n&&(this.showLoading(),w.send("GetPublicFiles",{Hash:A.PublicHash,Path:this.currentPath()},this.onGetFilesResponse,this))):(this.bNotLoading=o,this.bInPopup?this.onUserRoute(D.getParsedParams(e,t,i)):(n=f.setHash(D.getFiles(e,t,i)),n&&(this.showLoading(),s=""!==this.currentPath()&&0===this.pathItems().length,w.send("GetFiles",{Type:this.storageType(),Path:this.currentPath(),Pattern:this.searchPattern(),PathRequired:s},this.onGetFilesResponse,this),s&&this.showLoading())))},o.prototype.addPathItems=function(e,t,i){var o=new N;o.storageType(e),o.displayName(i),o.fileName(i),o.path(t),o.fullPath(t),this.pathItems.unshift(o)},o.prototype.onRoute=function(e){var t=D.parseFiles(e);c.isPublic()?this.onPublicRoute(t):this.onUserRoute(t)},o.prototype.onUserRoute=function(e){var t=e.Path,i=e.PathParts.reverse(),o=n.find(this.folders(),function(e){return e.fullPath()===t}),s=n.findIndex(this.pathItems(),function(e){return e.fullPath()===t}),r=[],a=!1;this.error(!1),this.storageType(e.Storage),this.currentPath(t),this.loadedFiles(!1),s!==-1?(n.each(this.pathItems(),function(e,t){t<=s&&r.push(e)}),this.pathItems.removeAll(),this.pathItems(r)):o?this.pathItems.push(o):"google"!==e.Storage||""===t?(this.pathItems.removeAll(),n.each(i,n.bind(function(i){var o=t.lastIndexOf(i);this.addPathItems(e.Storage,t,i),t=t.substr(0,o)},this))):a=!0,this.bNotLoading&&(this.files().length>0||this.folders().length>0)?this.timerId=setTimeout(n.bind(function(){this.loadedFiles()||this.error()||this.showLoading()},this),3e3):this.showLoading(),w.send("GetFiles",{Type:e.Storage,Path:e.Path,Pattern:l.pString(e.Search),PathRequired:a},this.onGetFilesResponse,this)},o.prototype.onPublicRoute=function(e){var t=e.Path,i=e.PathParts.reverse(),o="";this.currentPath(t),this.pathItems.removeAll(),n.each(i,n.bind(function(i){var n=t.lastIndexOf(i);this.addPathItems(e.Storage,t,i),t=t.substr(0,n),o=i},this)),o!==this.rootPath()&&this.addPathItems(e.Storage,"",this.rootPath()),this.showLoading(),w.send("GetPublicFiles",{Hash:A.PublicHash,Path:this.currentPath()},this.onGetFilesResponse,this)},o.prototype.deleteItems=function(e,t){var i=this.storageType(),o=this.currentPath();if(t&&0<e.length){var s=n.compact(n.map(e,function(e){return""!==e.id()?(e.deleted(!0),i=e.storageType(),o=e.path(),{Path:e.path(),Name:e.id()}):null}));s.length&&w.send("Delete",{Type:i,Path:o,Items:s},this.onDeleteResponse,this)}},o.prototype.getFileByName=function(e){return n.find(this.files(),function(t){return t.fileName()===e})},o.prototype.deleteFileByName=function(e){this.files(n.filter(this.files(),function(t){return t.id()!==e}))},o.prototype.deleteFolderByName=function(e){this.folders(n.filter(this.folders(),function(t){return t.fileName()!==e}))},o.prototype.expungeFileItems=function(){this.folders(n.filter(this.folders(),function(e){return!e.deleted()},this)),this.files(n.filter(this.files(),function(e){return!e.deleted()},this))},o.prototype.expungeExternalStorages=function(e){this.storages(n.filter(this.storages(),function(t){return!t.isExternal||n.include(e,t.type)},this))},o.prototype.getUploadFileByUid=function(e){return n.find(this.uploadingFiles(),function(t){return t.uploadUid()===e})},o.prototype.deleteUploadFileByUid=function(e){this.uploadingFiles(n.filter(this.uploadingFiles(),function(t){return t.uploadUid()!==e}))},o.prototype.getUploadingFiles=function(){return n.filter(this.uploadingFiles(),n.bind(function(e){return e.path()===this.currentPath()&&e.storageType()===this.storageType()},this))},o.prototype.onCancelUpload=function(e){this.oJua&&this.oJua.cancel(e),this.deleteUploadFileByUid(e)},o.prototype.onCreateFolderResponse=function(e,t){this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},o.prototype.createFolder=function(e){return e=s.trim(e),h.validateFileOrFolderName(e)?(w.send("CreateFolder",{Type:this.storageType(),Path:this.currentPath(),FolderName:e},this.onCreateFolderResponse,this),""):a.i18n("FILESWEBCLIENT/ERROR_INVALID_FOLDER_NAME")},o.prototype.onCreateFolderClick=function(){g.showPopup(S,[n.bind(this.createFolder,this)])},o.prototype.onCreateLinkResponse=function(e,t){this.routeFiles(this.storageType(),this.currentPath(),this.searchPattern(),!0)},o.prototype.createLink=function(e){w.send("CreateLink",{Type:this.storageType(),Path:this.currentPath(),Link:e.sLinkUrl,Name:e.fileName()},this.onCreateLinkResponse,this)},o.prototype.onCreateLinkClick=function(){var e=n.bind(this.createLink,this);g.showPopup(T,[e])},o.prototype.onSearch=function(){this.routeFiles(this.storageType(),this.currentPath(),this.newSearchPattern())},o.prototype.clearSearch=function(){this.routeFiles(this.storageType(),this.currentPath())},o.prototype.getCurrentFolder=function(){var e=new N;return e.fullPath(this.currentPath()),e.storageType(this.storageType()),e},o.prototype.registerToolbarButtons=function(e){l.isNonEmptyArray(e)&&(n.each(e,n.bind(function(e){n.isFunction(e.useFilesViewData)&&e.useFilesViewData(this)},this)),this.addToolbarButtons(n.union(this.addToolbarButtons(),e)))},o.prototype.onFileRemove=function(e,t){var i=n.bind(function(e,t){var i=[];i.push({Path:this.currentPath(),Name:t}),w.send("Delete",{Type:this.storageType(),Path:this.currentPath(),Items:i}),this.deleteUploadFileByUid(e)},this);t.downloading()?c.broadcastEvent("CFilesView::FileDownloadCancel",{oFile:t}):!t.uploaded()&&e&&c.broadcastEvent("CFilesView::FileUploadCancel",{sFileUploadUid:e,fOnUploadCancelCallback:i})},e.exports=o},315:function(e,t,i){"use strict";function o(){a.call(this),this.fCallback=null,this.folderName=r.observable(""),this.folderName.focus=r.observable(!1),this.folderName.error=r.observable(""),this.folderName.subscribe(function(){this.folderName.error("")},this)}var n=i(2),s=i(1),r=i(46),a=i(188);n.extendOwn(o.prototype,a.prototype),o.prototype.PopupTemplate="FilesWebclient_CreateFolderPopup",o.prototype.onOpen=function(e){this.folderName(""),this.folderName.focus(!0),this.folderName.error(""),s.isFunction(e)&&(this.fCallback=e)},o.prototype.onOKClick=function(){if(this.folderName.error(""),this.fCallback){var e=this.fCallback(this.folderName());e?this.folderName.error(""+e):this.closePopup()}else this.closePopup()},e.exports=new o},316:function(e,t,i){"use strict";function o(){l.call(this),this.fCallback=null,this.link=r.observable(""),this.linkPrev=r.observable(""),this.linkFocus=r.observable(!1),this.checkTimeout=null,this.urlChecked=r.observable(!1),this.saveCommand=a.createCommand(this,this.executeSave,function(){return this.urlChecked()}),this.fileItem=r.observable(null)}var n=i(2),s=i(1),r=i(46),a=i(211),l=i(188),h=i(317),u=i(318);n.extendOwn(o.prototype,l.prototype),o.prototype.PopupTemplate="FilesWebclient_CreateLinkPopup",o.prototype.onOpen=function(e){this.link(""),this.linkFocus(!0),this.fCallback=e,this.checkTimer=setTimeout(n.bind(this.checkUrl,this),2e3)},o.prototype.checkUrl=function(){clearTimeout(this.checkTimer),this.link()!==this.linkPrev()&&(this.linkPrev(this.link()),h.send("CheckUrl",{Url:this.link()},this.onCheckUrlResponse,this)),this.checkTimer=setTimeout(n.bind(this.checkUrl,this),1e3)},o.prototype.onCheckUrlResponse=function(e,t){if(e.Result){var i=u.prepareLinkData(e.Result,this.link()),o=new u(i);this.fileItem(o),this.urlChecked(!0)}},o.prototype.executeSave=function(){s.isFunction(this.fCallback)&&(this.fCallback(this.fileItem()),this.link(""),this.linkPrev(""),this.urlChecked(!1)),clearTimeout(this.checkTimer),this.closePopup()},o.prototype.cancelPopup=function(){this.link(""),this.linkPrev(""),this.urlChecked(!1),clearTimeout(this.checkTimer),this.closePopup()},e.exports=new o},317:function(e,t,i){"use strict";var o=i(185),n=i(313);o.registerAbortRequestHandler(n.ServerModuleName,function(e,t){switch(e.Method){case"GetFiles":return"GetFiles"===t.Method}return!1}),e.exports={send:function(e,t,i,s){o.send(n.ServerModuleName,e,t,i,s)},sendToWebclient:function(e,t,i,n){o.send("FilesWebclient",e,t,i,n)}}},318:function(e,t,i){"use strict";function o(e,t){this.storageType=s.observable(l.pString(e.Type)),this.sLastModified=o.parseLastModified(e.LastModified),this.path=s.observable(l.pString(e.Path)),this.fullPath=s.observable(l.pString(e.FullPath)),this.selected=s.observable(!1),this.checked=s.observable(!1),this.bIsLink=!!e.IsLink,this.oExtendedProps=e.ExtendedProps,this.sLinkType=this.bIsLink?l.pString(e.LinkType):"",this.sLinkUrl=this.bIsLink?l.pString(e.LinkUrl):"",this.sThumbnailExternalLink=this.bIsLink?l.pString(e.ThumbnailUrl):"",this.deleted=s.observable(!1),this.recivedAnim=s.observable(!1).extend({autoResetToFalse:500}),this.shared=s.observable(!1),this.sOwnerName=l.pString(e.Owner),p.call(this),this.content=s.observable(""),this.thumbUrlInQueueSubscribtion.dispose(),this.thumbUrlInQueue.subscribe(function(){""!==this.sThumbnailExternalLink?this.thumbnailSrc(this.sThumbnailExternalLink):this.bIsLink||this.getInThumbQueue()},this),this.oActionsData.list={Text:a.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:n.bind(function(){u.broadcastEvent("Files::ShowList",{Item:this})},this)},this.oActionsData.open={Text:a.i18n("COREWEBCLIENT/ACTION_OPEN_LINK"),Handler:n.bind(this.openLink,this)},this.iconAction(""),this.sHeaderText=n.bind(function(){if(this.sLastModified){var e=""!==this.sOwnerName?"FILESWEBCLIENT/INFO_OWNER_AND_DATA":"FILESWEBCLIENT/INFO_DATA";return a.i18n(e,{OWNER:this.sOwnerName,LASTMODIFIED:this.sLastModified})}return""},this)(),this.type=this.storageType,this.canShare=s.computed(function(){return this.storageType()===b.FileStorageType.Personal||this.storageType()===b.FileStorageType.Corporate},this),this.sHtmlEmbed=l.pString(e.OembedHtml),n.each(e.Actions,function(e,t){this.oActionsData[t]||(this.oActionsData[t]={}),this.oActionsData[t].Url=l.pString(e.url),this.actions.push(t)},this),this.cssClasses=s.computed(function(){var e=this.getCommonClasses();return this.allowDrag()&&e.push("dragHandle"),this.selected()&&e.push("selected"),this.checked()&&e.push("checked"),this.deleted()&&e.push("deleted"),this.allowSharing()&&this.shared()&&e.push("shared"),this.bIsLink&&e.push("aslink"),e.join(" ")},this),this.parse(e,t)}var n=i(2),s=i(46),r=i(51),a=i(43),l=i(44),h=i(211),u=i(179),c=i(194),p=i(319),d=i(255),f=i(186),m=i(321),b=window.Enums;n.extendOwn(o.prototype,p.prototype),o.parseLastModified=function(e){var t=new d;return e?(t.parse(e),t.getShortDate()):""},o.prepareLinkData=function(e,t){return{IsLink:!0,LinkType:e.LinkType,LinkUrl:t,Name:e.Name,Size:e.Size,ThumbnailUrl:e.Thumb}},o.prototype.parse=function(e,t){this.uploaded(!0),this.allowDrag(!t),this.allowUpload(!0),this.allowSharing(!0),this.allowActions(!t&&""!==this.fullPath()),this.fileName(l.pString(e.Name)),this.content(l.pString(e.Content)),this.id(l.pString(e.Id)),this.shared(!!e.Shared),this.size(l.pInt(e.Size)),this.hash(l.pString(e.Hash)),this.thumbUrlInQueue(l.pString(e.ThumbnailUrl)),this.mimeType(l.pString(e.ContentType)),this.bHasHtmlEmbed=!t&&""!==this.fullPath()&&"oembeded"===this.sLinkType,this.bHasHtmlEmbed&&this.iconAction("view"),this.isViewSupported()||this.bHasHtmlEmbed||this.actions(n.without(this.actions(),"view")),u.broadcastEvent("FilesWebclient::ParseFile::after",this)},o.prepareUploadFileData=function(e,t,i,o){var n=e.FileName,s=h.getFileExtension(n),a=h.getFileNameWithoutExtension(n),l=0;for(""!==s&&(s="."+s);o(n);)n=a+"_"+l+s,l++;return e.FileName=n,{Name:n,LastModified:r().unix(),Owner:u.getUserPublicId(),Path:t,Type:i,ContentType:e.Type,Size:e.Size}},o.prototype.viewFile=function(e,t){t&&(t.ctrlKey||t.shiftKey)||(""!==this.sHtmlEmbed?f.showPopup(m,[this.sHtmlEmbed]):this.bIsLink?this.viewCommonFile(this.sLinkUrl):this.viewCommonFile())},o.prototype.openLink=function(){this.bIsLink&&c.openTab(this.sLinkUrl)},e.exports=o},319:function(e,t,i){"use strict";function o(){this.id=r.observable(""),this.index=r.observable(0),this.fileName=r.observable(""),this.tempName=r.observable(""),this.displayName=r.observable(""),this.extension=r.observable(""),this.fileName.subscribe(function(e){this.id(e),this.displayName(e),this.extension(p.getFileExtension(e))},this),this.size=r.observable(0),this.friendlySize=r.computed(function(){return this.size()>0?h.getFriendlySize(this.size()):""},this),this.hash=r.observable(""),this.thumbUrlInQueue=r.observable(""),this.thumbUrlInQueueSubscribtion=this.thumbUrlInQueue.subscribe(function(){this.getInThumbQueue()},this),this.thumbnailSrc=r.observable(""),this.thumbnailLoaded=r.observable(!1),this.thumbnailSessionUid=r.observable(""),this.mimeType=r.observable(""),this.uploadUid=r.observable(""),this.uploaded=r.observable(!1),this.uploadError=r.observable(!1),this.downloading=r.observable(!1),this.isViewMimeType=r.computed(function(){return-1!==s.inArray(this.mimeType(),f)},this),this.bHasHtmlEmbed=!1,this.otherTemplates=r.observableArray([]),this.statusText=r.observable(""),this.statusTooltip=r.computed(function(){return this.uploadError()?this.statusText():""},this),this.progressPercent=r.observable(0),this.visibleProgress=r.observable(!1),this.uploadStarted=r.observable(!1),this.uploadStarted.subscribe(function(){this.uploadStarted()?(this.uploaded(!1),this.visibleProgress(!0),this.progressPercent(20)):(this.progressPercent(100),this.visibleProgress(!1),this.uploaded(!0))},this),this.downloading.subscribe(function(){this.downloading()?this.visibleProgress(!0):(this.visibleProgress(!1),this.progressPercent(0))},this),this.allowDrag=r.observable(!1),this.allowUpload=r.observable(!1),this.allowSharing=r.observable(!1),this.bIsSecure=r.observable(!1),this.sHeaderText="",this.oActionsData={view:{Text:h.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:n.bind(function(){this.viewFile()},this)},download:{Text:h.i18n("COREWEBCLIENT/ACTION_DOWNLOAD_FILE"),Handler:n.bind(function(){this.downloadFile()},this),Tooltip:r.computed(function(){var e=h.i18n("COREWEBCLIENT/INFO_CLICK_TO_DOWNLOAD_FILE",{FILENAME:this.fileName(),SIZE:this.friendlySize()});return""===this.friendlySize()&&(e=e.replace(" ()","")),e},this)}},this.allowActions=r.observable(!0),this.iconAction=r.observable("download"),this.cssClasses=r.computed(function(){return this.getCommonClasses().join(" ")},this),this.actions=r.observableArray([]),this.firstAction=r.computed(function(){return this.actions().length>1?this.actions()[0]:""},this),this.secondAction=r.computed(function(){return 1===this.actions().length?this.actions()[0]:this.actions().length>1?this.actions()[1]:""},this),this.subFiles=r.observableArray([]),this.subFilesExpanded=r.observable(!1)}var n=i(2),s=i(1),r=i(46),a=i(179),l=i(320),h=i(43),u=i(44),c=i(177),p=i(211),d=i(194),f=["image/jpeg","image/png","image/gif","text/html","text/plain","text/css","text/rfc822-headers","message/delivery-status","application/x-httpd-php","application/javascript"],m=[];s("html").hasClass("pdf")&&(f.push("application/pdf"),f.push("application/x-pdf")),o.prototype.addAction=function(e,t,i){t?this.actions.unshift(e):this.actions.push(e),this.actions(n.compact(this.actions())),i&&(this.oActionsData[e]=i)},o.prototype.removeAction=function(e){this.actions(n.without(this.actions(),e))},o.prototype.getMainAction=function(){return this.actions()[0]},o.prototype.hasAction=function(e){return n.indexOf(this.actions(),e)!==-1},o.prototype.getActionText=function(e){return this.hasAction(e)&&this.oActionsData[e]&&("string"==typeof this.oActionsData[e].Text||n.isFunction(this.oActionsData[e].Text))?this.oActionsData[e].Text:""},o.prototype.getActionUrl=function(e){return this.hasAction(e)&&this.oActionsData[e]?this.oActionsData[e].Url||"":""},o.prototype.executeAction=function(e){this.hasAction(e)&&this.oActionsData[e]&&n.isFunction(this.oActionsData[e].Handler)&&this.oActionsData[e].Handler()},o.prototype.getTooltip=function(e){var t=this.hasAction(e)&&this.oActionsData[e]?this.oActionsData[e].Tooltip:"";return"string"==typeof t?t:n.isFunction(t)?t():""},o.prototype.getCommonClasses=function(){var e=[];return(this.allowUpload()&&!this.uploaded()||this.downloading())&&e.push("incomplete"),this.uploadError()?e.push("fail"):e.push("success"),e},o.prototype.parse=function(e){this.fileName(u.pString(e.FileName)),this.tempName(u.pString(e.TempName)),""===this.tempName()&&this.tempName(this.fileName()),this.mimeType(u.pString(e.MimeType)),this.size(e.EstimatedSize?u.pInt(e.EstimatedSize):u.pInt(e.SizeInBytes)),this.hash(u.pString(e.Hash)),this.parseActions(e),this.uploadUid(this.hash()),this.uploaded(!0),s.isFunction(this.additionalParse)&&this.additionalParse(e)},o.prototype.parseActions=function(e){this.commonParseActions(e)},o.prototype.commonParseActions=function(e){this.thumbUrlInQueue(u.pString(e.ThumbnailUrl)),n.each(e.Actions,function(e,t){this.oActionsData[t]||(this.oActionsData[t]={}),this.oActionsData[t].Url=u.pString(e.url),this.actions.push(t)},this)},o.addViewExtensions=function(e){n.isArray(e)&&(m=n.union(m,e))},o.prototype.isViewSupported=function(){return-1!==s.inArray(this.mimeType(),f)||-1!==s.inArray(this.extension(),m)},o.prototype.getInThumbQueue=function(){""===this.thumbUrlInQueue()||this.linked&&(!this.linked||this.linked())||(this.thumbnailSessionUid(""+Date.now()),l.thumbQueue(this.thumbnailSessionUid(),this.thumbUrlInQueue(),this.thumbnailSrc))},o.prototype.downloadFile=function(){var e=this.getActionUrl("download"),t={File:this,CancelDownload:!1};e.length>0&&"#"!==e&&(a.broadcastEvent("AbstractFileModel::FileDownload::before",t),t.CancelDownload||(n.isFunction(t.CustomDownloadHandler)?t.CustomDownloadHandler():c.downloadByUrl(e)))},o.prototype.viewFile=function(e,t){p.calmEvent(t),this.viewCommonFile()},o.prototype.viewCommonFile=function(e){var t=null,i=null;u.isNonEmptyString(e)||(e=c.getAppPath()+this.getActionUrl("view")),e.length>0&&"#"!==e&&(i={sUrl:e,index:this.index(),bBreakView:!1},a.broadcastEvent("AbstractFileModel::FileView::before",i),i.bBreakView||(t=d.open(e,e,!1),t&&t.focus()))},o.prototype.eventDragStart=function(e,t){var i=t.originalEvent||t;return e&&i&&i.dataTransfer&&i.dataTransfer.setData&&i.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},o.prototype.generateTransferDownloadUrl=function(){var e=this.getActionUrl("download");
return"http"!==e.substr(0,4)&&(e=c.getAppPath()+e),this.mimeType()+":"+this.fileName()+":"+e},o.prototype.onUploadSelect=function(e,t,i){i||(this.fileName(u.pString(t.FileName)),this.mimeType(u.pString(t.Type)),this.size(u.pInt(t.Size))),this.uploadUid(e),this.uploaded(!1),this.statusText(""),this.progressPercent(0),this.visibleProgress(!1)},o.prototype.onUploadStart=function(){this.visibleProgress(!0)},o.prototype.onUploadProgress=function(e,t){t>0&&(this.progressPercent(Math.ceil(e/t*100)),this.visibleProgress(!0))},o.prototype.onDownloadProgress=function(e,t){t>0&&(this.progressPercent(Math.ceil(e/t*100)),this.visibleProgress(this.progressPercent()<100))},o.prototype.onUploadComplete=function(e,t,i){var o=!(t&&i&&!i.ErrorCode&&i.Result&&!i.Result.Error),n=i&&i.Result&&"size"===i.Result.Error?h.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):h.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN");this.progressPercent(0),this.visibleProgress(!1),this.uploaded(!0),this.uploadError(o),this.statusText(o?n:h.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),o||(this.fillDataAfterUploadComplete(i,e),setTimeout(function(e){return function(){e.statusText("")}}(this),3e3))},o.prototype.fillDataAfterUploadComplete=function(e,t){},o.prototype.onImageLoad=function(e,t){""===this.thumbUrlInQueue()||this.thumbnailLoaded()||(this.thumbnailLoaded(!0),l.thumbQueue(this.thumbnailSessionUid()))},o.prototype.stopDownloading=function(){this.downloading(!1)},o.prototype.startDownloading=function(){this.downloading(!0)},e.exports=o},320:function(e,t,i){"use strict";var o=i(43),n=i(186),s=i(187),r=i(45),a={};a.getDownloadLink=function(e,t,i){return t.length>0?"?/Download/"+e+"/DownloadFile/"+t+"/"+(i?"0/"+i:""):""},a.getIframeWrappwer=function(e,t){return"?/Raw/Iframe/"+e+"/"+window.encodeURIComponent(t)+"/"},a.thumbQueue=function(){var e={},t={},i=2;return function(o,n,s){n&&s?!(o in t)||t[o]>0?(o in t||(t[o]=i,e[o]=[]),t[o]--,s(n)):e[o].push({imageSrc:n,imageSrcObserver:s,messageUid:o}):e[o]&&e[o].length&&(e[o][0].imageSrcObserver(e[o][0].imageSrc),e[o].shift())}}(),a.showErrorIfAttachmentSizeLimit=function(e,t){var i=o.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE_DETAILED",{FILENAME:e,MAXSIZE:o.getFriendlySize(r.AttachmentSizeLimit)});return r.AttachmentSizeLimit>0&&t>r.AttachmentSizeLimit&&(n.showPopup(s,[i]),!0)},e.exports=a},321:function(e,t,i){"use strict";function o(){r.call(this),this.htmlEmbed=s.observable("")}var n=i(2),s=i(46),r=i(188);n.extendOwn(o.prototype,r.prototype),o.prototype.PopupTemplate="CoreWebclient_EmbedHtmlPopup",o.prototype.onOpen=function(e){this.htmlEmbed(e)},o.prototype.close=function(){this.closePopup(),this.htmlEmbed("")},e.exports=new o},322:function(e,t,i){"use strict";function o(){a.call(this),this.fCallback=null,this.name=r.observable(""),this.focused=r.observable(!1),this.error=r.observable(""),this.name.subscribe(function(){this.error("")},this)}var n=i(2),s=i(1),r=i(46),a=i(188);n.extendOwn(o.prototype,a.prototype),o.prototype.PopupTemplate="FilesWebclient_RenamePopup",o.prototype.onOpen=function(e,t){this.fCallback=t,this.name(e),this.focused(!0),this.error("")},o.prototype.onOKClick=function(){if(this.error(""),s.isFunction(this.fCallback)){var e=this.fCallback(this.name());e?this.error(e):this.closePopup()}else this.closePopup()},e.exports=new o},323:function(e,t,i){"use strict";function o(){a.call(this),this.item=null,this.pub=s.observable(""),this.pubFocus=s.observable(!1)}var n=i(2),s=i(46),r=i(177),a=i(188),l=i(317),h=i(324);n.extendOwn(o.prototype,a.prototype),o.prototype.PopupTemplate="FilesWebclient_SharePopup",o.prototype.onOpen=function(e){this.item=e,this.pub(""),l.send("CreatePublicLink",{Type:e.storageType(),Path:e.path(),Name:e.fileName(),Size:e instanceof h?0:e.size(),IsFolder:e instanceof h},this.onCreatePublicLinkResponse,this)},o.prototype.onCreatePublicLinkResponse=function(e,t){e.Result&&(this.pub(r.getAppPath()+e.Result),this.pubFocus(!0),this.item.shared(!0))},o.prototype.onCancelSharingClick=function(){this.item&&(l.send("DeletePublicLink",{Type:this.item.storageType(),Path:this.item.path(),Name:this.item.fileName()},this.closePopup,this),this.item.shared(!1))},e.exports=new o},324:function(e,t,i){"use strict";function o(){this.selected=n.observable(!1),this.checked=n.observable(!1),this.deleted=n.observable(!1),this.recivedAnim=n.observable(!1).extend({autoResetToFalse:500}),this.shared=n.observable(!1),this.fileName=n.observable(""),this.fullPath=n.observable(""),this.path=n.observable(""),this.storageType=n.observable(Enums.FileStorageType.Personal),this.displayName=n.observable(""),this.id=n.observable(""),this.sMainAction="list"}var n=i(46),s=i(44),r=i(319);o.prototype.parse=function(e){this.shared(!!e.Shared),this.fileName(s.pString(e.Name)),this.fullPath(s.pString(e.FullPath)),this.path(s.pString(e.Path)),this.storageType(s.pString(e.Type)),this.displayName(this.fileName()),this.id(s.pString(e.Id)),e.MainAction&&(this.sMainAction=s.pString(e.MainAction))},o.prototype.getMainAction=function(){return this.sMainAction},o.prototype.eventDragStart=r.prototype.eventDragStart,e.exports=o},325:function(e,t,i){"use strict";function o(e){return h===e.substr(0,h.length)}function n(e){return l===e.substr(0,l.length)}var s=i(2),r=i(44),a=i(313),l="s.",h="p.",u={};u.getFiles=function(e,t,i){var o=[a.HashModuleName];return e&&""!==e&&o.push(e),t&&""!==t&&o.push(h+t),i&&""!==i&&o.push(l+i),o},u.parseFiles=function(e){var t=0,i="personal",s="",a="";return r.isNonEmptyArray(e)&&(e.length>t&&!o(e[t])&&(i=r.pString(e[t]),t++),e.length>t&&o(e[t])&&(s=r.pString(e[t].substr(h.length)),t++),e.length>t&&n(e[t])&&(a=r.pString(e[t].substr(l.length)))),u.getParsedParams(i,s,a)},u.getParsedParams=function(e,t,i){var o=[],n="";return r.isNonEmptyString(t)?(o=s.without(t.split(/(?:\/|\$ZIP\:)/g),""),n=o[o.length-1]):t="",{Storage:e,Path:t,PathParts:o,Name:n,Search:i}},e.exports=u},326:function(e,t,i){"use strict";function o(){r.call(this),this.oFilesView=new a(!0),this.oFilesView.onSelectClickPopupBound=n.bind(this.onSelectClick,this),this.fCallback=null}var n=i(2),s=i(1),r=i(188),a=i(314),l=i(318);n.extendOwn(o.prototype,r.prototype),o.prototype.PopupTemplate="FilesWebclient_SelectFilesPopup",o.prototype.onOpen=function(e){s.isFunction(e)&&(this.fCallback=e),this.oFilesView.onShow()},o.prototype.onBind=function(){this.oFilesView.onBind(this.$popupDom)},o.prototype.onSelectClick=function(){var e=this.oFilesView.selector.listCheckedAndSelected(),t=n.filter(e,function(e){return e instanceof l},this);this.fCallback&&this.fCallback(t),this.closePopup()},e.exports=new o},327:function(e,t,i){"use strict";function o(){a.call(this,"FilesWebclient"),this.bShowFilesApps=l.ShowFilesApps,this.sAppPath=r.getAppPath()}var n=i(2),s=i(42),r=i(177),a=s.run("SettingsWebclient","getAbstractSettingsFormViewClass"),l=i(313);n.extendOwn(o.prototype,a.prototype),o.prototype.ViewTemplate="FilesWebclient_FilesSettingsFormView",e.exports=new o},328:function(e,t,i){"use strict";function o(){this.davServer=n.observable(""),this.credentialsHintText=s.mobileCredentialsHintText,this.bDemo=r.IsDemo}var n=i(46),s=i(179),r=i(45);o.prototype.ViewTemplate="FilesWebclient_MobileSyncSettingsView",o.prototype.populate=function(e){this.davServer(e.Server)},e.exports=new o}});