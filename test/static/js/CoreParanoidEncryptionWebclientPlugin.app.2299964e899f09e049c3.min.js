webpackJsonp([5],{233:function(t,e,i){"use strict";function n(){l.call(this),this.fConfirmCallback=null,this.confirmDesc=s.observable(""),this.popupHeading=s.observable(""),this.okButtonText=s.observable(a.i18n("COREWEBCLIENT/ACTION_OK")),this.cancelButtonText=s.observable(a.i18n("COREWEBCLIENT/ACTION_CANCEL")),this.shown=!1}var o=i(2),r=i(1),s=i(46),a=i(43),l=i(188);o.extendOwn(n.prototype,l.prototype),n.prototype.PopupTemplate="CoreWebclient_ConfirmPopup",n.prototype.onOpen=function(t,e,i,n,o){this.confirmDesc(t),this.popupHeading(i||""),this.okButtonText(n||a.i18n("COREWEBCLIENT/ACTION_OK")),this.cancelButtonText(o||a.i18n("COREWEBCLIENT/ACTION_CANCEL")),r.isFunction(e)&&(this.fConfirmCallback=e),this.shown=!0},n.prototype.onHide=function(){this.shown=!1},n.prototype.onEnterHandler=function(){this.yesClick()},n.prototype.yesClick=function(){this.shown&&this.fConfirmCallback&&this.fConfirmCallback(!0),this.closePopup()},n.prototype.cancelPopup=function(){this.fConfirmCallback&&this.fConfirmCallback(!1),this.closePopup()},t.exports=new n},266:function(t,e,i){var n,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,i=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in n,r=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},s=/constructor/i.test(t.HTMLElement)||t.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},u="application/octet-stream",p=4e4,c=function(t){var e=function(){"string"==typeof t?i().revokeObjectURL(t):t.remove()};setTimeout(e,p)},h=function(t,e,i){e=[].concat(e);for(var n=e.length;n--;){var o=t["on"+e[n]];if("function"==typeof o)try{o.call(t,i||t)}catch(t){l(t)}}},d=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},y=function(e,l,p){p||(e=d(e));var y,f=this,E=e.type,C=E===u,b=function(){h(f,"writestart progress write writeend".split(" "))},w=function(){if((a||C&&s)&&t.FileReader){var n=new FileReader;return n.onloadend=function(){var e=a?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;"),i=t.open(e,"_blank");i||(t.location.href=e),e=void 0,f.readyState=f.DONE,b()},n.readAsDataURL(e),void(f.readyState=f.INIT)}if(y||(y=i().createObjectURL(e)),C)t.location.href=y;else{var o=t.open(y,"_blank");o||(t.location.href=y)}f.readyState=f.DONE,b(),c(y)};return f.readyState=f.INIT,o?(y=i().createObjectURL(e),void setTimeout(function(){n.href=y,n.download=l,r(n),b(),c(y),f.readyState=f.DONE})):void w()},f=y.prototype,E=function(t,e,i){return new y(t,e||t.name||"download",i)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=d(t)),navigator.msSaveOrOpenBlob(t,e)}:(f.abort=function(){},f.readyState=f.INIT=0,f.WRITING=1,f.DONE=2,f.error=f.onwritestart=f.onprogress=f.onwrite=f.onabort=f.onerror=f.onwriteend=null,E)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports?t.exports.saveAs=o:null!==i(48)&&null!==i(267)&&(n=function(){return o}.call(e,i,e,t),!(void 0!==n&&(t.exports=n)))},267:function(t,e){(function(e){t.exports=e}).call(e,{})},275:function(t,e,i){"use strict";function n(){return f.chrome&&!o()?!!window.crypto:!!window.crypto&&!!window.crypto.subtle}function o(){return"https:"===window.location.protocol}function r(t,e,i,n,o){C?E.push({sUid:t,oFileInfo:e}):(setTimeout(function(){h.showPopup(y,[i,n,E.length,s.map(E,function(t){return t.oFileInfo.FileName}),o])},10),C=!0,E.push({sUid:t,oFileInfo:e}))}i(276);var s=i(2),a=i(179),l=i(43),u=i(182),p=i(277),c=i(280),h=i(186),d=i(281),y=i(282),f=i(178),E=[],C=!1;t.exports=function(t){return c.init(t),{start:function(t){n()&&(t.run("SettingsWebclient","registerSettingsTab",[function(){return i(283)},c.HashModuleName,l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/LABEL_SETTINGS_TAB")]),a.subscribeEvent("AbstractFileModel::FileDownload::before",function(t){var e=t.File,i="oExtendedProps"in e&&("InitializationVector"in e.oExtendedProps&&e.oExtendedProps.InitializationVector);c.EnableJscrypto()&&i&&e.sOwnerName===a.getUserPublicId()&&(o()?p.getCryptoKey()?t.CustomDownloadHandler=function(){e.startDownloading(),p.downloadDividedFile(e,i)}:(u.showError(l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/INFO_EMPTY_JSCRYPTO_KEY")),t.CancelDownload=!0):(u.showError(l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_HTTPS_NEEDED")),t.CancelDownload=!0))}),a.subscribeEvent("Jua::FileUpload::before",function(t){var e=t.sUid,i=t.sModuleName,n=t.oFileInfo,a=t.fOnChunkReadyCallback,y=t.fRegularUploadFileCallback,f=t.fCancelFunction,b=function(t,e,i){p.oChunkQueue.isProcessed=!0,p.start(t),p.readChunk(e,i)},w=s.bind(function(){E.forEach(function(t){y(t.sUid,t.oFileInfo)}),E=[],C=!1},this),N=s.bind(function(){E.forEach(function(t){p.oChunkQueue.aFiles.push({fStartUploadCallback:b,oFileInfo:t.oFileInfo,sUid:t.sUid,fOnChunkEncryptCallback:a})}),E=[],C=!1,p.oChunkQueue.isProcessed||(p.oChunkQueue.isProcessed=!0,p.checkQueue())}),P=s.bind(function(){E.forEach(function(t){f(t.sUid)}),E=[],C=!1});!c.EnableJscrypto()||c.EncryptionAllowedModules&&c.EncryptionAllowedModules.length>0&&!c.EncryptionAllowedModules.includes(i)||c.EncryptionMode()==Enums.EncryptionMode.Never?y(e,n):o()?p.getCryptoKey()?c.EncryptionMode()==Enums.EncryptionMode.AskMe?C?E.push({sUid:e,oFileInfo:n}):(setTimeout(function(){h.showPopup(d,[N,w,P,E.length,s.map(E,function(t){return t.oFileInfo.FileName})])},10),C=!0,E.push({sUid:e,oFileInfo:n})):p.oChunkQueue.isProcessed===!0?p.oChunkQueue.aFiles.push({fStartUploadCallback:b,oFileInfo:n,sUid:e,fOnChunkEncryptCallback:a}):b(n,e,a):c.EncryptionMode()==Enums.EncryptionMode.Always?(u.showError(l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/INFO_EMPTY_JSCRYPTO_KEY")),f(e)):c.EncryptionMode()==Enums.EncryptionMode.AskMe&&r(e,n,w,P,l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/INFO_EMPTY_JSCRYPTO_KEY")):c.EncryptionMode()==Enums.EncryptionMode.Always?(u.showError(l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_HTTPS_NEEDED")),f(e)):c.EncryptionMode()==Enums.EncryptionMode.AskMe&&r(e,n,w,P,l.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_HTTPS_NEEDED"))}),a.subscribeEvent("CFilesView::FileDownloadCancel",function(t){c.EnableJscrypto()&&o()&&t.oFile.stopDownloading()}),a.subscribeEvent("CFilesView::FileUploadCancel",function(t){c.EnableJscrypto()&&o()&&p.stopUploading(t.sFileUploadUid,t.fOnUploadCancelCallback)}),a.subscribeEvent("Jua::FileUploadingError",function(){c.EnableJscrypto()&&o()&&(p.oChunkQueue.isProcessed=!1,p.checkQueue())}),a.subscribeEvent("FilesWebclient::ParseFile::after",function(t){var e=void 0!==t.oExtendedProps&&void 0!==t.oExtendedProps.InitializationVector,i=!!e&&t.oExtendedProps.InitializationVector;e&&(t.thumbnailSrc(""),t.sOwnerName===a.getUserPublicId()&&/\.(png|jpe?g|gif)$/.test(t.fileName())&&c.EnableJscrypto()?t.oActionsData.view.Handler=s.bind(function(){p.viewEncryptedImage(this.oFile,this.iv)},{oFile:t,iv:i}):t.removeAction("view"),t.removeAction("list"),t.bIsSecure(!0))}),a.subscribeEvent("FileViewerWebclientPlugin::FilesCollection::after",function(t){t.aFilesCollection(s.filter(t.aFilesCollection(),function(t){return!(void 0!==t.oExtendedProps&&void 0!==t.oExtendedProps.InitializationVector)}))}))}}}},276:function(t,e,i){"use strict";var n=i(2),o={};o.EncryptionMode={Always:0,AskMe:1,Never:2},void 0===window.Enums&&(window.Enums={}),n.extendOwn(window.Enums,o)},277:function(t,e,i){"use strict";function n(){this.iChunkNumber=0,this.iChunkSize=5242880,this.iCurrChunk=0,this.oChunk=null,this.iv=null,this.cryptoKey=p.observable(y.getKey()),y.getKeyObservable().subscribe(function(){this.cryptoKey(y.getKey())},this),this.oChunkQueue={isProcessed:!1,aFiles:[]},this.aStopList=[],this.fOnUploadCancelCallback=null}function o(t,e,i,n){this.oFile=t,this.sFileName=t.fileName(),this.iFileSize=t.size(),this.sDownloadLink=t.getActionUrl("download"),this.oWriter=new s(this.sFileName),this.iCurrChunk=0,this.iv=new Uint8Array(f.HexString2Array(e)),this.key=i,this.iChunkNumber=Math.ceil(this.iFileSize/n),this.iChunkSize=n,this.decryptChunk()}function r(t,e,i,n){this.oFile=t,this.sFileName=t.fileName(),this.iFileSize=t.size(),this.sDownloadLink=t.getActionUrl("download"),this.oWriter=null,this.iCurrChunk=0,this.iv=new Uint8Array(f.HexString2Array(e)),this.key=i,this.iChunkNumber=Math.ceil(this.iFileSize/n),this.iChunkSize=n,this.decryptChunk()}function s(t){this.sName=t,this.aBuffer=[]}function a(t){this.sName=t,this.aBuffer=[],this.imgWindow=window.open("","_blank","height=auto, width=auto,toolbar=no,scrollbars=no,resizable=yes")}var l=i(1),u=i(2),p=i(46),c=i(182),h=i(43),d=i(266),y=i(278),f=i(279);n.prototype.start=function(t){this.oFileInfo=t,this.oFile=t.File,this.iChunkNumber=Math.ceil(t.File.size/this.iChunkSize),this.iCurrChunk=0,this.oChunk=null,this.iv=window.crypto.getRandomValues(new Uint8Array(16)),this.oFileInfo.Hidden={RangeType:1},this.oFileInfo.Hidden.ExtendedProps={InitializationVector:f.Array2HexString(new Uint8Array(this.iv))}},n.prototype.getCryptoKey=function(){return this.cryptoKey()},n.prototype.readChunk=function(t,e){var i=this.iChunkSize*this.iCurrChunk,n=this.iCurrChunk<this.iChunkNumber-1?this.iChunkSize*(this.iCurrChunk+1):this.oFile.size,o=new FileReader,r=null;if(this.aStopList.indexOf(t)!==-1)return this.aStopList.splice(this.aStopList.indexOf(t),1),null!==this.fOnUploadCancelCallback&&this.fOnUploadCancelCallback(t,this.oFileInfo.FileName),void this.checkQueue();if(this.oFile.slice?r=this.oFile.slice(i,n):this.oFile.webkitSlice?r=this.oFile.webkitSlice(i,n):this.oFile.mozSlice&&(r=this.oFile.mozSlice(i,n)),r)try{o.onloadend=u.bind(function(i){i.target.readyState===FileReader.DONE&&(this.oChunk=i.target.result,this.iCurrChunk++,this.encryptChunk(t,e))},this),o.readAsArrayBuffer(r)}catch(t){c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_ENCRYPTION"))}},n.prototype.encryptChunk=function(t,e){crypto.subtle.encrypt({name:"AES-CBC",iv:this.iv},this.cryptoKey(),this.oChunk).then(u.bind(function(i){i=this.iChunkNumber>1&&this.iCurrChunk!==this.iChunkNumber?i.slice(0,i.byteLength-16):i;var n=new Blob([i],{type:"text/plain",lastModified:new Date}),o=u.bind(function(t,e){this.iCurrChunk<this.iChunkNumber?this.readChunk(t,e):(this.oChunkQueue.isProcessed=!1,this.checkQueue())},this);this.oFileInfo.File=n,this.iv=new Uint8Array(i.slice(i.byteLength-16)),1===this.iCurrChunk?this.oFileInfo.Hidden.ExtendedProps.FirstChunk=!0:delete this.oFileInfo.Hidden.ExtendedProps.FirstChunk,this.iCurrChunk==this.iChunkNumber?delete this.oFileInfo.Hidden.ExtendedProps.Loading:this.oFileInfo.Hidden.ExtendedProps.Loading=!0,e(t,this.oFileInfo,o,this.iCurrChunk,this.iChunkNumber,(this.iCurrChunk-1)*this.iChunkSize)},this)).catch(function(t){c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_ENCRYPTION"))})},n.prototype.downloadDividedFile=function(t,e){new o(t,e,this.cryptoKey(),this.iChunkSize)},n.prototype.checkQueue=function(){var t=null;this.oChunkQueue.aFiles.length>0&&(t=this.oChunkQueue.aFiles.shift(),t.fStartUploadCallback.apply(t.fStartUploadCallback,[t.oFileInfo,t.sUid,t.fOnChunkEncryptCallback]))},n.prototype.stopUploading=function(t,e){var i=!1;this.oChunkQueue.aFiles.forEach(function(n,o,r){n.sUid===t&&(e(t,n.oFileInfo.FileName),r.splice(o,1),i=!0)}),i||(this.aStopList.push(t),this.oChunkQueue.isProcessed=!1,this.fOnUploadCancelCallback=e)},n.prototype.viewEncryptedImage=function(t,e){this.getCryptoKey()?new r(t,e,this.cryptoKey(),this.iChunkSize):c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/INFO_EMPTY_JSCRYPTO_KEY"))},o.prototype.writeChunk=function(t){this.oFile.downloading()===!0&&(this.oWriter.write(t),this.iCurrChunk<this.iChunkNumber?this.decryptChunk():(this.stopDownloading(),this.oWriter.close()))},o.prototype.decryptChunk=function(){var t=new XMLHttpRequest;t.open("GET",this.getChunkLink(),!0),t.responseType="arraybuffer",t.onprogress=u.bind(function(e){this.oFile.downloading()?this.oFile.onDownloadProgress(e.loaded+(this.iCurrChunk-1)*this.iChunkSize,this.iFileSize):t.abort()},this),t.onload=u.bind(function(e){var i=t.response,n={};200===t.status&&i&&(n=new Uint8Array(i.byteLength+16),n.set(new Uint8Array(i),0),this.iCurrChunk!==this.iChunkNumber?crypto.subtle.encrypt({name:"AES-CBC",iv:new Uint8Array(i.slice(i.byteLength-16))},this.key,new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]).buffer).then(u.bind(function(t){n.set(new Uint8Array(new Uint8Array(t.slice(0,16))),i.byteLength),crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,n.buffer).then(u.bind(function(t){var e=new Uint8Array(t);this.iv=new Uint8Array(i.slice(i.byteLength-16)),this.writeChunk(e)},this)).catch(u.bind(function(t){this.stopDownloading(),c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_DECRYPTION"))},this))},this)):crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv},this.key,i).then(u.bind(function(t){var e=new Uint8Array(t);this.iv=new Uint8Array(i.slice(i.byteLength-16)),this.writeChunk(e)},this)).catch(u.bind(function(t){this.stopDownloading(),c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_DECRYPTION"))},this)))},this),t.send(null)},o.prototype.stopDownloading=function(){this.oFile.stopDownloading()},o.prototype.getChunkLink=function(){return this.sDownloadLink+"/download/"+this.iCurrChunk++ +"/"+this.iChunkSize},r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.writeChunk=function(t){this.oWriter=null===this.oWriter?new a(this.sFileName):this.oWriter,this.oWriter.write(t),this.iCurrChunk<this.iChunkNumber?this.decryptChunk():(this.stopDownloading(),this.oWriter.close())},r.prototype.stopDownloading=function(){},s.prototype.write=function(t){this.aBuffer.push(t)},s.prototype.close=function(){var t=new Blob(this.aBuffer);d.saveAs(t,this.sName),t=null},a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype.close=function(){try{var t=new Blob(this.aBuffer),e=window.URL.createObjectURL(t),i=null;this.imgWindow.document.write("<head><title>"+this.sName+'</title></head><body><img src="'+e+'" /></body>'),i=l(this.imgWindow.document.body).find("img"),i.on("load",function(){window.URL.revokeObjectURL(e)})}catch(t){c.showError(h.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_POPUP_WINDOWS"))}},t.exports=new n},278:function(t,e,i){"use strict";function n(){this.sPrefix="user_"+(u.UserId||"0")+"_",this.key=r.observable(),this.sKeyName=r.observable(),this.loadKeyFromStorage()}var o=i(2),r=i(46),s=i(43),a=i(215),l=i(182),u=i(45),p=i(279);n.prototype.key=null,n.prototype.sPrefix="",n.prototype.getKey=function(){return this.key()},n.prototype.getKeyName=function(){return!!a.hasData(this.sPrefix+"cryptoKey")&&a.getData(this.sPrefix+"cryptoKey").keyname},n.prototype.getKeyObservable=function(){return this.key},n.prototype.loadKeyFromStorage=function(t){var e=[],i="";a.hasData(this.sPrefix+"cryptoKey")&&(i=a.getData(this.sPrefix+"cryptoKey").keydata,e=p.HexString2Array(i),e.length>0?(e=new Uint8Array(e),window.crypto.subtle.importKey("raw",e.buffer,{name:"AES-CBC"},!0,["encrypt","decrypt"]).then(o.bind(function(e){this.key(e),t&&t(!0)},this)).catch(function(t){l.showError(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_LOAD_KEY"))})):l.showError(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_LOAD_KEY")))},n.prototype.generateKey=function(t,e){window.crypto.subtle.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]).then(o.bind(function(i){window.crypto.subtle.exportKey("raw",i).then(o.bind(function(i){a.setData(this.sPrefix+"cryptoKey",{keyname:e,keydata:p.Array2HexString(new Uint8Array(i))}),this.loadKeyFromStorage(t)},this)).catch(function(t){l.showError(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_EXPORT_KEY"))})},this)).catch(function(t){l.showError(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_GENERATE_KEY"))})},n.prototype.importKeyFromString=function(t,e){try{this.sKeyName(t),a.setData(this.sPrefix+"cryptoKey",{keyname:t,keydata:e})}catch(t){l.showError(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_IMPORT_KEY"))}this.loadKeyFromStorage()},n.prototype.exportKey=function(){return window.crypto.subtle.exportKey("raw",this.getKey())},n.prototype.deleteKey=function(){try{this.key(null),a.removeData(this.sPrefix+"cryptoKey")}catch(t){return{error:t}}return this.loadKeyFromStorage(),{status:"ok"}},t.exports=new n},279:function(t,e,i){"use strict";var n=i(2),o={};o.Array2HexString=function(t){var e="";return n.each(t,function(t){var i=t.toString(16);e+=(1===i.length?"0":"")+i}),e},o.HexString2Array=function(t){var e=[];if(0===t.length||t.length%2!==0)return e;for(var i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},t.exports=o},280:function(t,e,i){"use strict";var n=i(46),o=i(2),r=i(44);t.exports={ServerModuleName:"CoreParanoidEncryptionWebclientPlugin",HashModuleName:"paranoid-encryption",EncryptionAllowedModules:["Files"],EnableJscrypto:n.observable(!0),EncryptionMode:n.observable(Enums.EncryptionMode.Always),init:function(t){var e=o.extend({},t[this.ServerModuleName]||{},t.CoreParanoidEncryptionWebclientPlugin||{});o.isEmpty(e)||(this.EnableJscrypto(r.pBool(e.EnableModule,this.EnableJscrypto())),this.EncryptionMode(r.pEnum(e.EncryptionMode,Enums.EncryptionMode,this.EncryptionMode())))},update:function(t,e){this.EnableJscrypto(t),this.EncryptionMode(e)}}},281:function(t,e,i){"use strict";function n(){a.call(this),this.fEncrypt=null,this.fUpload=null,this.fCancel=null,this.message=r.observable(""),this.filesConfirmText=r.observable("")}var o=i(2),r=i(46),s=i(43),a=i(188);o.extendOwn(n.prototype,a.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_ConfirmEncryptionPopup",n.prototype.onOpen=function(t,e,i,n,r){var a=o.map(r,function(t){return s.encodeHtml(t)});this.filesConfirmText(""),this.fEncrypt=t,this.fUpload=e,this.fCancel=i,this.message(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/CONFIRM_ENCRYPT_PLURAL",{VALUE:n>1?n:'"'+r[0]+'"'},null,n)),n>1&&this.filesConfirmText(a.join("<br />"))},n.prototype.cancelUpload=function(){this.fCancel(),this.closePopup()},n.prototype.encrypt=function(){this.fEncrypt(),this.closePopup()},n.prototype.upload=function(){this.fUpload(),this.closePopup()},t.exports=new n},282:function(t,e,i){"use strict";function n(){a.call(this),this.fUpload=null,this.fCancel=null,this.message=r.observable(""),this.filesConfirmText=r.observable(""),this.sErrorText=r.observable("")}var o=i(2),r=i(46),s=i(43),a=i(188);o.extendOwn(n.prototype,a.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_ConfirmUploadPopup",n.prototype.onOpen=function(t,e,i,n,r){var a=o.map(n,function(t){return s.encodeHtml(t)});this.filesConfirmText(""),this.fUpload=t,this.fCancel=e,this.message(s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/CONFIRM_UPLOAD_PLURAL",{VALUE:i>1?i:'"'+n[0]+'"'},null,i)),i>1&&this.filesConfirmText(a.join("<br />")),this.sErrorText(r)},n.prototype.cancelUpload=function(){this.fCancel(),this.closePopup()},n.prototype.upload=function(){this.fUpload(),this.closePopup()},t.exports=new n},283:function(t,e,i){"use strict";function n(){c.call(this,y.ServerModuleName),this.EnableJscrypto=s.observable(y.EnableJscrypto()),this.key=s.observable(d.getKey()),this.keyName=s.observable(d.getKeyName()),this.downloadLinkHref=s.observable("#"),this.setExportUrl(),d.getKeyObservable().subscribe(function(){this.key(d.getKey()),this.keyName(d.getKeyName()),this.setExportUrl()},this),this.bIsHttpsEnable="https:"===window.location.protocol,this.EncryptionMode=s.observable(y.EncryptionMode()),this.isImporting=s.observable(!1)}var o=i(2),r=i(1),s=i(46),a=i(43),l=i(44),u=i(42),p=i(182),c=u.run("SettingsWebclient","getAbstractSettingsFormViewClass"),h=i(186),d=i(278),y=i(280),f=i(284),E=i(285),C=i(286),b=i(287),w=i(279);o.extendOwn(n.prototype,c.prototype),n.prototype.ViewTemplate="CoreParanoidEncryptionWebclientPlugin_ParanoidEncryptionSettingsFormView",n.prototype.setExportUrl=function(t){var e="#",i=null;this.downloadLinkHref(e),window.Blob&&window.URL&&o.isFunction(window.URL.createObjectURL)&&d.getKey()&&d.exportKey().then(o.bind(function(n){i=new Blob([w.Array2HexString(new Uint8Array(n))],{type:"text/plain"}),e=window.URL.createObjectURL(i),this.downloadLinkHref(e),t&&h.showPopup(C,[e,this.keyName()])},this))},n.prototype.importFileKey=function(){r("#import-key-file").click()},n.prototype.importStringKey=function(){h.showPopup(f,[!1])},n.prototype.readKeyFromFile=function(){var t=document.getElementById("import-key-file"),e=t.files[0],i=new FileReader,n="",r=t.files[0].name.split("."),s="";if(r.splice(r.length-1,1),s=r.join(""),!e)return void p.showError(a.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_IMPORT_KEY"));this.isImporting(!0),i.onload=o.bind(function(t){n=t.target.result,d.importKeyFromString(s,n),this.isImporting(!1)},this);try{i.readAsText(e)}catch(t){p.showError(a.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_IMPORT_KEY"))}},n.prototype.generateNewKey=function(){h.showPopup(E,[o.bind(this.setExportUrl,this)])},n.prototype.removeJscryptoKey=function(){var t=o.bind(function(t){if(t){var e=d.deleteKey();e.error&&p.showError(a.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/ERROR_DELETE_KEY"))}},this);h.showPopup(b,[this.downloadLinkHref(),this.keyName(),t])},n.prototype.getCurrentValues=function(){return[this.EnableJscrypto(),this.EncryptionMode()]},n.prototype.revertGlobalValues=function(){this.EnableJscrypto(y.EnableJscrypto()),this.EncryptionMode(y.EncryptionMode())},n.prototype.getParametersForSave=function(){return{EnableModule:this.EnableJscrypto(),EncryptionMode:l.pInt(this.EncryptionMode())}},n.prototype.applySavedValues=function(){y.update(this.EnableJscrypto(),this.EncryptionMode())},t.exports=new n},284:function(t,e,i){"use strict";function n(){a.call(this),this.keyName=r.observable(s.getUserPublicId()),this.newKey=r.observable("")}var o=i(2),r=i(46),s=i(179),a=i(188),l=i(278);o.extendOwn(n.prototype,a.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_ImportKeyStringPopup",n.prototype.onOpen=function(){this.newKey("")},n.prototype.importKey=function(){l.importKeyFromString(this.keyName(),this.newKey()),this.closePopup()},t.exports=new n},285:function(t,e,i){"use strict";function n(){a.call(this),this.keyName=r.observable(s.getUserPublicId()),this.fOnGenerateCallback=null}var o=i(2),r=i(46),s=i(179),a=i(188),l=i(278);o.extendOwn(n.prototype,a.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_GenerateKeyPopup",n.prototype.onOpen=function(t){this.fOnGenerateCallback=t},n.prototype.generateKey=function(){l.generateKey(this.fOnGenerateCallback,this.keyName()),this.closePopup()},t.exports=new n},286:function(t,e,i){"use strict";function n(){s.call(this),this.downloadLink=r.observable("#"),this.keyName=r.observable("")}var o=i(2),r=i(46),s=i(188);o.extendOwn(n.prototype,s.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_ExportInformationPopup",n.prototype.onOpen=function(t,e){this.downloadLink(t),this.keyName(e)},t.exports=new n},287:function(t,e,i){"use strict";function n(){a.call(this),this.downloadLink=r.observable(""),this.keyName=r.observable(""),this.fDelete=null,this.fDeleteCallback=null}var o=i(2),r=i(46),s=i(43),a=i(188),l=i(186),u=i(233);o.extendOwn(n.prototype,a.prototype),n.prototype.PopupTemplate="CoreParanoidEncryptionWebclientPlugin_DeleteKeyPopup",n.prototype.onOpen=function(t,e,i){this.downloadLink(t),this.keyName(e),this.fDeleteCallback=o.bind(function(t){i.call(this,t),t?this.closePopup():this.showPopup()},this)},n.prototype.deleteKey=function(){this.hidePopup(),l.showPopup(u,[s.i18n("COREPARANOIDENCRYPTIONWEBCLIENTPLUGIN/CONFIRM_DELETE_KEY"),this.fDeleteCallback])},t.exports=new n}});